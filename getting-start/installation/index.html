<!DOCTYPE html>
<html>
  <head>
    <title>DocDock Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2022-03-21T00:23:01 CET">
<title>Installation :: DocDock Documentation</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/featherlight.min.css" rel="stylesheet">
<link href="/css/auto-complete.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79101-13', 'auto');
  ga('send', 'pageview');

</script>

    
  </head>
  <body data-url="/getting-start/installation/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="/">DocDock Documentation</a>
  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock/archive/master.zip"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/getting-start/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/getting-start/">This is Great</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/getting-start/installation/" class="dd-item">
        <div>
          <a href="/getting-start/installation/">
            Installation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/getting-start/configuration/" class="dd-item">
        <div>
          <a href="/getting-start/configuration/">
            Windows Keberos Attack
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/create-page/" class="dd-item haschildren
        ">
      <div>
      <a href="/create-page/"><i class='fa fa-edit' ></i> Create Page</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/create-page/homepage/" class="dd-item">
        <div>
          <a href="/create-page/homepage/">
            Home page
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/create-page/page-images/" class="dd-item">
        <div>
          <a href="/create-page/page-images/">
            About images
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/create-page/page-slide/" class="dd-item">
        <div>
          <a href="/create-page/page-slide/">
            Present a Slide
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/content-organisation/" class="dd-item haschildren
        ">
      <div>
      <a href="/content-organisation/">Content Organisation</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/content-organisation/logo/" class="dd-item">
        <div>
          <a href="/content-organisation/logo/">
            Logo placeholder
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/content-organisation/extramenu/" class="dd-item">
        <div>
          <a href="/content-organisation/extramenu/">
            Extra menu entries
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/content-organisation/customize-style/" class="dd-item haschildren
        ">
      <div>
      <a href="/content-organisation/customize-style/">Customize website look and feel</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/content-organisation/customize-style/disable/" class="dd-item">
        <div>
          <a href="/content-organisation/customize-style/disable/">
            Disable features
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/content-organisation/customize-style/themestyle/" class="dd-item">
        <div>
          <a href="/content-organisation/customize-style/themestyle/">
            Theme styles
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/content-organisation/customize-style/theme-variants/" class="dd-item">
        <div>
          <a href="/content-organisation/customize-style/theme-variants/">
            Theme variants
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/shortcodes/" class="dd-item haschildren
        ">
      <div>
      <a href="/shortcodes/">Shortcodes</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/shortcodes/alert/" class="dd-item">
        <div>
          <a href="/shortcodes/alert/">
            alert
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/attachments/" class="dd-item">
        <div>
          <a href="/shortcodes/attachments/">
            attachments
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/button/" class="dd-item">
        <div>
          <a href="/shortcodes/button/">
            button
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/shortcodes/children/" class="dd-item haschildren
        ">
      <div>
      <a href="/shortcodes/children/">children</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/shortcodes/children/children-1/" class="dd-item haschildren
        ">
      <div>
      <a href="/shortcodes/children/children-1/">page 1</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/shortcodes/children/children-1/children-1-1/" class="dd-item haschildren
        ">
      <div>
      <a href="/shortcodes/children/children-1/children-1-1/">page 1-1</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/shortcodes/children/children-1/children-1-1/children-1-1-1/" class="dd-item haschildren
        ">
      <div>
      <a href="/shortcodes/children/children-1/children-1-1/children-1-1-1/">page 1-1-1</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/shortcodes/children/children-1/children-1-1/children-1-1-1/children-1-1-1-1/" class="dd-item haschildren
        ">
      <div>
      <a href="/shortcodes/children/children-1/children-1-1/children-1-1-1/children-1-1-1-1/">page 1-1-1-1</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/shortcodes/children/children-1/children-1-1/children-1-1-1/children-1-1-1-1/children-1-1-1-1-1/" class="dd-item
        ">
      <div>
      <a href="/shortcodes/children/children-1/children-1-1/children-1-1-1/children-1-1-1-1/children-1-1-1-1-1/">page 1-1-1-1-1</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/shortcodes/children/children-2/" class="dd-item haschildren
        ">
      <div>
      <a href="/shortcodes/children/children-2/">page 2</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/shortcodes/children/children-2/test3/" class="dd-item">
        <div>
          <a href="/shortcodes/children/children-2/test3/">
            page test 3
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/shortcodes/children/children-3/" class="dd-item
        ">
      <div>
      <a href="/shortcodes/children/children-3/">page 3</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
      <li data-nav-id="/shortcodes/children/test/" class="dd-item">
        <div>
          <a href="/shortcodes/children/test/">
            page test
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/shortcodes/excerpt/" class="dd-item">
        <div>
          <a href="/shortcodes/excerpt/">
            excerpt
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/excerpt-include/" class="dd-item">
        <div>
          <a href="/shortcodes/excerpt-include/">
            excerpt-include
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/expand/" class="dd-item">
        <div>
          <a href="/shortcodes/expand/">
            expand
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/icon/" class="dd-item">
        <div>
          <a href="/shortcodes/icon/">
            icon
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/mermaid/" class="dd-item">
        <div>
          <a href="/shortcodes/mermaid/">
            mermaid
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/notice/" class="dd-item">
        <div>
          <a href="/shortcodes/notice/">
            notice
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/panel/" class="dd-item">
        <div>
          <a href="/shortcodes/panel/">
            panel
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shortcodes/revealjs/" class="dd-item">
        <div>
          <a href="/shortcodes/revealjs/">
            revealjs
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/search/" class="dd-item
        ">
      <div>
      <a href="/search/">About the Search Engine</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>




    </ul>
    <section><center>

<a class="github-button" href="https://github.com/vjeantet/hugo-theme-docdock/archive/master.zip" data-icon="octicon-cloud-download" aria-label="Download vjeantet/hugo-theme-docdock on GitHub">Download</a>


<a class="github-button" href="https://github.com/vjeantet/hugo-theme-docdock" data-icon="octicon-star" data-show-count="false" aria-label="Star vjeantet/hugo-theme-docdock on GitHub">Star</a>


<a class="github-button" href="https://github.com/vjeantet/hugo-theme-docdock/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork vjeantet/hugo-theme-docdock on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/getting-start/" >
   This is Great</option> 
      <option value="/getting-start/installation/"  selected>- Installation</option>
      <option value="/getting-start/configuration/" >- Windows Keberos Attack</option>
  
    <option value="/create-page/" >
   Create Page</option>
    <option value="/content-organisation/" >
   Content Organisation</option>
    <option value="/shortcodes/" >
   Shortcodes</option>
    <option value="/search/" >
   About the Search Engine</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
      </div>
    

    <h1>Installation</h1>
    
    
    
    <p>Do you use <strong>Hacktricks every day</strong>? Did you find the book <strong>very</strong> <strong>useful</strong>? Would you like to <strong>receive extra help</strong> with cybersecurity questions? Would you like to <strong>find more and higher quality content on Hacktricks</strong>? <a href="https://github.com/sponsors/carlospolop"><strong>Support Hacktricks through github sponsors</strong></a> <strong>so we can dedicate more time to it and also get access to the Hacktricks private group where you will get the help you need and much more!</strong></p>
<p>If you want to know about my <strong>latest modifications</strong>/<strong>additions</strong> or you have <strong>any suggestion for HackTricks</strong> or <strong>PEASS</strong>, <strong>join the</strong> <a href="https://emojipedia.org/speech-balloon/"><strong>üí¨</strong></a><a href="https://discord.gg/hRep4RUj7f"><strong>Discord group</strong></a> or the <a href="https://t.me/peass"><strong>telegram group</strong></a>, or <strong>follow</strong> me on <strong>Twitter</strong> <a href="https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/%5Bhttps:/emojipedia.org/bird/README.md"><strong>üê¶</strong></a><a href="https://twitter.com/carlospolopm"><strong>@carlospolopm</strong></a><strong>.</strong> If you want to <strong>share some tricks with the community</strong> you can also submit <strong>pull requests</strong> to <a href="https://github.com/carlospolop/hacktricks"><strong>https://github.com/carlospolop/hacktricks</strong></a> that will be reflected in this book and don&rsquo;t forget to <strong>give ‚≠ê</strong> on <strong>github</strong> to <strong>motivate</strong> <strong>me</strong> to continue developing this book.</p>
<ol>
<li>
<ol>
<li></li>
</ol>
</li>
</ol>
<pre><code>1.  1.
    
    Select the **victim domain**.
    
2.  2.
    
    Perform some basic web enumeration **searching for login portals** used by the victim and **decide** which one you will **impersonate**.
    
3.  3.
    
    Use some **OSINT** to **find emails**.
</code></pre>
<ol start="2">
<li>
<ol start="2">
<li></li>
</ol>
</li>
</ol>
<pre><code>1.  1.
    
    **Buy the domain** you are going to use for the phishing assessment
    
2.  2.
    
    **Configure the email service** related records (SPF, DMARC, DKIM, rDNS)
    
3.  3.
    
    Configure the VPS with **gophish**
</code></pre>
<ol start="3">
<li>
<ol start="3">
<li></li>
</ol>
</li>
</ol>
<pre><code>1.  1.
    
    Prepare the **email template**
    
2.  2.
    
    Prepare the **web page** to steal the credentials
</code></pre>
<h2 id="heading"></h2>
<p>Generate similar domain names or buy a trusted domain</p>
<h2 id="heading-1"></h2>
<p>Domain Name Variation Techniques</p>
<ul>
<li>
<p><strong>Keyword</strong>: The domain name <strong>contains</strong> an important <strong>keyword</strong> of the original domain (e.g., zelster.com-management.com).</p>
</li>
<li>
<p><strong>hypened subdomain</strong>: Change the <strong>dot for a hyphen</strong> of a subdomain (e.g., www-zelster.com).</p>
</li>
<li>
<p><strong>New TLD</strong>: Same domain using a <strong>new TLD</strong> (e.g., zelster.org)</p>
</li>
<li>
<p><strong>Homoglyph</strong>: It <strong>replaces</strong> a letter in the domain name with <strong>letters that look similar</strong> (e.g., zelfser.com).</p>
</li>
<li>
<p><strong>Transposition:</strong> It <strong>swaps two letters</strong> within the domain name (e.g., zelster.com).</p>
</li>
<li>
<p><strong>Singularization/Pluralization</strong>: Adds or removes ‚Äús‚Äù at the end of the domain name (e.g., zeltsers.com).</p>
</li>
<li>
<p><strong>Omission</strong>: It <strong>removes one</strong> of the letters from the domain name (e.g., zelser.com).</p>
</li>
<li>
<p><strong>Repetition:</strong> It <strong>repeats one</strong> of the letters in the domain name (e.g., zeltsser.com).</p>
</li>
<li>
<p><strong>Replacement</strong>: Like homoglyph but less stealthy. It replaces one of the letters in the domain name, perhaps with a letter in proximity of the original letter on the keyboard (e.g, zektser.com).</p>
</li>
<li>
<p><strong>Subdomained</strong>: Introduce a <strong>dot</strong> inside the domain name (e.g., ze.lster.com).</p>
</li>
<li>
<p><strong>Insertion</strong>: It <strong>inserts a letter</strong> into the domain name (e.g., zerltser.com).</p>
</li>
<li>
<p><strong>Missing dot</strong>: Append the TLD to the domain name. (e.g., zelstercom.com)</p>
</li>
</ul>
<h3 id="heading-2"></h3>
<p>Automatic Tools</p>
<h3 id="heading-3"></h3>
<p><strong>Websites</strong></p>
<h2 id="heading-4"></h2>
<p>Bitflipping</p>
<p>In the world of computing, everything is stored in bits (zeros and ones) in memory behind the scenes. This applies to domains too. For example, <em>windows.com</em> becomes <em>01110111&hellip;</em> in the volatile memory of your computing device. However, what if one of these bits got automatically flipped due to a solar flare, cosmic rays, or a hardware error? That is one of the 0&rsquo;s becomes a 1 and vice versa. Applying this concept to DNS request, it&rsquo;s possible that the <strong>domain requested</strong> that arrives to the DNS server <strong>isn&rsquo;t the same as the domain initially requested.</strong></p>
<p>For example a 1 bit modification in the domain microsoft.com can transform it into <em>windnws.com.</em> <strong>Attackers may register as many bit-flipping domains as possible related to the victim in order to redirect legitimate users to their infrastructure</strong>.</p>
<h2 id="heading-5"></h2>
<p>Buy a trusted domain</p>
<p>You can search in <a href="https://www.expireddomains.net/">https://www.expireddomains.net/</a> for a expired domain that you could use. In order to make sure that the expired domain that you are going to buy <strong>has already a good SEO</strong> you could search how is it categorized in:</p>
<h2 id="heading-6"></h2>
<p>Discovering Emails</p>
<p>In order to <strong>discover more</strong> valid email addresses or <strong>verify the ones</strong> you have already discovered you can check if you can brute-force them smtp servers of the victim. <a href="https://github.com/carlospolop/hacktricks/blob/master/phishing-methodology/broken-reference/README.md">Learn how to verify/discover email address here</a>. Moreover, don&rsquo;t forget that if the users use <strong>any web portal to access their mails</strong>, you can check if it&rsquo;s vulnerable to <strong>username brute force</strong>, and exploit the vulnerability if possible.</p>
<h2 id="heading-7"></h2>
<p>Configuring GoPhish</p>
<h2 id="heading-8"></h2>
<p>Installation</p>
<p>Download and decompress it inside <code>/opt/gophish</code> and execute <code>/opt/gophish/gophish</code> You will be given a password for the admin user in port 3333 in the output. Therefore, access that port and use those credentials to change the admin password. You may need to tunnel that port to local:</p>
<p>ssh -L 3333:127.0.0.1:3333 &lt;user&gt;@&lt;ip&gt;</p>
<h2 id="heading-9"></h2>
<p>Configuration</p>
<h3 id="heading-10"></h3>
<p>TLS certificate configuration</p>
<p>Before this step you should have <strong>already bought the domain</strong> you are going to use and it must be <strong>pointing</strong> to the <strong>IP of the VPS</strong> where you are configuring <strong>gophish</strong>.</p>
<p>wget <a href="https://dl.eff.org/certbot-auto">https://dl.eff.org/certbot-auto</a></p>
<p>sudo apt-get remove certbot</p>
<p>sudo snap install &ndash;classic certbot</p>
<p>sudo ln -s /snap/bin/certbot /usr/bin/certbot</p>
<p>certbot certonly &ndash;standalone -d &ldquo;$DOMAIN&rdquo;</p>
<p>mkdir /opt/gophish/ssl_keys</p>
<p>cp &ldquo;/etc/letsencrypt/live/$DOMAIN/privkey.pem&rdquo; /opt/gophish/ssl_keys/key.pem</p>
<p>cp &ldquo;/etc/letsencrypt/live/$DOMAIN/fullchain.pem&rdquo; /opt/gophish/ssl_keys/key.crt</p>
<h3 id="heading-11"></h3>
<p>Mail configuration</p>
<p>Start installing: <code>apt-get install postfix</code></p>
<p>Then add the domain to the following files:</p>
<ul>
<li>
<p><strong>/etc/postfix/virtual_domains</strong></p>
</li>
<li>
<p><strong>/etc/postfix/virtual_regexp</strong></p>
</li>
</ul>
<p><strong>Change also the values of the following variables inside /etc/postfix/main.cf</strong></p>
<p><code>myhostname = &lt;domain&gt;</code> <code>mydestination = $myhostname, &lt;domain&gt;, localhost.com, localhost</code></p>
<p>Finally modify the files <strong><code>/etc/hostname</code></strong> and <strong><code>/etc/mailname</code></strong> to your domain name and <strong>restart your VPS.</strong></p>
<p>Now, create a <strong>DNS A record</strong> of <code>mail.&lt;domain&gt;</code> pointing to the <strong>ip address</strong> of the VPS and a <strong>DNS MX</strong> record pointing to <code>mail.&lt;domain&gt;</code></p>
<p>Now lets test to send an email:</p>
<p>echo &ldquo;This is the body of the email&rdquo; | mail -s &ldquo;This is the subject line&rdquo; <a href="mailto:test@email.com">test@email.com</a></p>
<h3 id="heading-12"></h3>
<p>Gophish configuration</p>
<p>Stop the execution of gophish and lets configure it. Modify <code>/opt/gophish/config.json</code> to the following (note the use of https):</p>
<p>&ldquo;listen_url&rdquo;: &ldquo;127.0.0.1:3333&rdquo;,</p>
<p>&ldquo;cert_path&rdquo;: &ldquo;gophish_admin.crt&rdquo;,</p>
<p>&ldquo;key_path&rdquo;: &ldquo;gophish_admin.key&rdquo;</p>
<p>&ldquo;listen_url&rdquo;: &ldquo;0.0.0.0:443&rdquo;,</p>
<p>&ldquo;cert_path&rdquo;: &ldquo;/opt/gophish/ssl_keys/key.crt&rdquo;,</p>
<p>&ldquo;key_path&rdquo;: &ldquo;/opt/gophish/ssl_keys/key.pem&rdquo;</p>
<p>&ldquo;migrations_prefix&rdquo;: &ldquo;db/db_&rdquo;,</p>
<h3 id="heading-13"></h3>
<p>Configure gophish service</p>
<p>In order to create the gophish service so it can be started automatically and managed a service you can create the file <code>/etc/init.d/gophish</code> with the following content:</p>
<p># initialization file for stop/start of gophish application server</p>
<p># description: stops/starts gophish application server</p>
<p># config:/opt/gophish/config.json</p>
<p># From <a href="https://github.com/gophish/gophish/issues/586">https://github.com/gophish/gophish/issues/586</a></p>
<p># define script variables</p>
<p>appDirectory=/opt/gophish</p>
<p>logfile=/var/log/gophish/gophish.log</p>
<p>errfile=/var/log/gophish/gophish.error</p>
<p>echo &lsquo;Starting &lsquo;${processName}&rsquo;&hellip;&rsquo;</p>
<p>nohup ./$process &gt;&gt;$logfile 2&gt;&gt;$errfile &amp;</p>
<p>echo &lsquo;Stopping &lsquo;${processName}&rsquo;&hellip;&rsquo;</p>
<p>pid=$(/bin/pidof ${process})</p>
<p>pid=$(/bin/pidof ${process})</p>
<p>if [[&quot;$pid&quot; != &ldquo;&quot;| &ldquo;$pid&rdquo; != &quot;&rdquo; ]]; then</p>
<p>echo ${processName}' is running&hellip;'</p>
<p>echo ${processName}' is not running&hellip;'</p>
<p>start|stop|status) &ldquo;$1&rdquo; ;;</p>
<p>Finish configuring the service and checking it doing:</p>
<p>chmod +x /etc/init.d/gophish</p>
<p>update-rc.d gophish defaults</p>
<h2 id="heading-14"></h2>
<p>Configuring mail server and domain</p>
<h2 id="heading-15"></h2>
<p>Wait</p>
<p>The older a domain is the less probable it&rsquo;s going to be caught as spam. Then you should wait as much time as possible (at least 1week) before the phishing assessment. Note that even if you have to wait a week you can finish configuring everything now.</p>
<h2 id="heading-16"></h2>
<p>Configure Reverse DNS (rDNS) record</p>
<p>Set a rDNS (PTR) record that resolves the IP address of the VPS to the domain name.</p>
<h2 id="heading-17"></h2>
<p>Sender Policy Framework (SPF) Record</p>
<p>You must <strong>configure a SPF record for the new domain</strong>. If you don&rsquo;t know what is a SPF record <a href="https://book.hacktricks.xyz/pentesting/pentesting-smtp#spf"><strong>read this page</strong></a>.</p>
<p><img src="https://1517081779-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_2uGJGU7AVNRcqRvEi%2F-MNxj6VJqZ-yo5g5O5Pi%2F-MNy9DnMPBAzJzIv5ATE%2Fimage.png?alt=media&amp;token=49f51809-3f96-4a71-85d2-000c3dc69a29" alt=""></p>
<p>This is the content that must be set inside a TXT record inside the domain:</p>
<p>v=spf1 mx a ip4:ip.ip.ip.ip ?all</p>
<h2 id="heading-18"></h2>
<p>Domain-based Message Authentication, Reporting &amp; Conformance (DMARC) Record</p>
<p>You must <strong>configure a DMARC record for the new domain</strong>. If you don&rsquo;t know what is a DMARC record <a href="https://book.hacktricks.xyz/pentesting/pentesting-smtp#dmarc"><strong>read this page</strong></a>.</p>
<p>You have to create a new DNS TXT record pointing the hostname <code>_dmarc.&lt;domain&gt;</code> with the following content:</p>
<h2 id="heading-19"></h2>
<p>DomainKeys Identified Mail (DKIM)</p>
<p>You must <strong>configure a DKIM for the new domain</strong>. If you don&rsquo;t know what is a DMARC record <a href="https://book.hacktricks.xyz/pentesting/pentesting-smtp#dkim"><strong>read this page</strong></a>.</p>
<p>You need to concatenate both B64 values that the DKIM key generates:</p>
<p>v=DKIM1; h=sha256; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0wPibdqPtzYk81njjQCrChIcHzxOp8a1wjbsoNtka2X9QXCZs+iXkvw++QsWDtdYu3q0Ofnr0Yd/TmG/Y2bBGoEgeE+YTUG2aEgw8Xx42NLJq2D1pB2lRQPW4IxefROnXu5HfKSm7dyzML1gZ1U0pR5X4IZCH0wOPhIq326QjxJZm79E1nTh3xj&quot; &ldquo;Y9N/Dt3+fVnIbMupzXE216TdFuifKM6Tl6O/axNsbswMS1TH812euno8xRpsdXJzFlB9q3VbMkVWig4P538mHolGzudEBg563vv66U8D7uuzGYxYT4WS8NVm3QBMg0QKPWZaKp+bADLkOSB9J2nUpk4Aj9KB5swIDAQAB</p>
<h2 id="heading-20"></h2>
<p>Test your email configuration score</p>
<p>echo &ldquo;This is the body of the email&rdquo; | mail -s &ldquo;This is the subject line&rdquo; <a href="mailto:test-iimosa79z@srv1.mail-tester.com">test-iimosa79z@srv1.mail-tester.com</a></p>
<p>You can also c<strong>heck your email configuration</strong> sending an email to <code>check-auth@verifier.port25.com</code> and <strong>reading the response</strong> (for this you will need to <strong>open</strong> port <strong>25</strong> and see the response in the file <em>/var/mail/root</em> if you send the email a as root). Check that you pass all the tests:</p>
<p>==========================================================</p>
<p>==========================================================</p>
<p>DomainKeys check: neutral</p>
<p>Alternatively, you can send a <strong>message to a Gmail address that you control</strong>, <strong>view</strong> the received <strong>email‚Äôs headers</strong> in your Gmail inbox, <code>dkim=pass</code> should be present in the <code>Authentication-Results</code> header field.</p>
<p>Authentication-Results: mx.google.com;</p>
<p>spf=pass (google.com: domain of <a href="mailto:contact@example.com">contact@example.com</a> designates &mdash; as permitted sender) <a href="mailto:smtp.mail=contact@example.com">smtp.mail=contact@example.com</a>;</p>
<p>dkim=pass <a href="mailto:header.i=@example.com">header.i=@example.com</a>;</p>
<h2 id="heading-21"></h2>
<p>Removing from Spamhouse Blacklist</p>
<p>The page <a href="http://www.mail-tester.com">www.mail-tester.com</a> can indicate you if you your domain is being blocked by spamhouse. You can request your domain/IP to be removed at: <a href="https://www.spamhaus.org/lookup/">https://www.spamhaus.org/lookup/</a></p>
<h2 id="heading-22"></h2>
<p>Removing from Microsoft Blacklist</p>
<h2 id="heading-23"></h2>
<p>Create &amp; Launch GoPhish Campaign</p>
<h2 id="heading-24"></h2>
<p>Sending Profile</p>
<ul>
<li>
<p>Set some <strong>name to identify</strong> the sender profile</p>
</li>
<li>
<p>Decide from which account are you going to send the phishing emails. Suggestions: <em>noreply, support, servicedesk, salesforce&hellip;</em></p>
</li>
<li>
<p>You can leave blank the username and password, but make sure to check the Ignore Certificate Errors</p>
</li>
</ul>
<p><img src="https://1517081779-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_2uGJGU7AVNRcqRvEi%2Fsync%2Fb2fe24f436b209350f0a6770c78f15782269b389.png?generation=1627813080136012&amp;alt=media" alt=""></p>
<p>It&rsquo;s recommended to use the &ldquo;<strong>Send Test Email</strong>&rdquo; functionality to test that everything is working. I would recommend to <strong>send the test emails to 10min mails addresses</strong> in order to avoid getting blacklisted making tests.</p>
<h2 id="heading-25"></h2>
<p>Email Template</p>
<ul>
<li>
<p>Set some <strong>name to identify</strong> the template</p>
</li>
<li>
<p>Then write a <strong>subject</strong> (nothing estrange, just something you could expect to read in a regular email)</p>
</li>
<li>
<p>Make sure you have checked &ldquo;<strong>Add Tracking Image</strong>&rdquo;</p>
</li>
<li>
<p>Write the <strong>email template</strong> (you can use variables like in the following example):</p>
</li>
</ul>
<p class\="MsoNormal"\><span style\="font-size:10.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:black"\>Dear {{.FirstName}} {{.LastName}},</span\></p\>
<p class\="MsoNormal"\><span style\="font-size:10.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:black"\>As you may be aware, due to the large number of employees working from home, the "PLATFORM NAME" platform is being migrated to a new domain with an improved and more secure version. To finalize account migration, please use the following link to log into the new HR portal and move your account to the new site: <a href\="{{.URL}}"\> "PLATFORM NAME" login portal </a\><br />
<p>Please Note: We require all users to move their accounts by 04/01/2021. Failure to confirm account migration may prevent you from logging into the application after the migration process is complete.<br /></p>
<p>WRITE HERE SOME SIGNATURE OF SOMEONE FROM THE COMPANY</p>
<p>Note that <strong>in order to increase the credibility of the email</strong>, it&rsquo;s recommended to use some signature from an email from the client. Suggestions:</p>
<ul>
<li>
<p>Send an email to a <strong>non existent address</strong> and check if the response has any signature.</p>
</li>
<li>
<p>Search for <strong>public emails</strong> like <a href="mailto:info@ex.com">info@ex.com</a> or <a href="mailto:press@ex.com">press@ex.com</a> or <a href="mailto:public@ex.com">public@ex.com</a> and send them an email and wait for the response.</p>
</li>
<li>
<p>Try to contact <strong>some valid discovered</strong> email and wait for the response</p>
</li>
</ul>
<p><img src="https://1517081779-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_2uGJGU7AVNRcqRvEi%2F-MP57QZ0GUcYziLqQcGL%2F-MP59y_KMpfhvek0DD69%2Fimage.png?alt=media&amp;token=4f501e75-71a8-4b80-954c-261cf90c370e" alt=""></p>
<p>The Email Template also allows to <strong>attach files to send</strong>. If you would also like to steal NTLM challenges using some specially crafted files/documents <a href="https://book.hacktricks.xyz/windows/ntlm/places-to-steal-ntlm-creds">read this page</a>.</p>
<h2 id="heading-26"></h2>
<p>Landing Page</p>
<ul>
<li>
<p><strong>Write the HTML code</strong> of the web page. Note that you can <strong>import</strong> web pages.</p>
</li>
<li>
<p>Mark <strong>Capture Submitted Data</strong> and <strong>Capture Passwords</strong></p>
</li>
</ul>
<p><img src="https://1517081779-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_2uGJGU7AVNRcqRvEi%2F-MP57QZ0GUcYziLqQcGL%2F-MP5DCfBC62fJ6UNiATf%2Fimage.png?alt=media&amp;token=4d81913f-4344-4b23-bfec-0bc17fe8e065" alt=""></p>
<p>Usually you will need to modify the HTML code of the page and make some tests in local (maybe using some Apache server) <strong>until you like the results.</strong> Then, write that HTML code in the box. Note that if you need to <strong>use some static resources</strong> for the HTML (maybe some CSS and JS pages) you can save them in <strong><em>/opt/gophish/static/endpoint</em></strong> and then access them from <strong><em>/static/<filename></em></strong></p>
<p>For the redirection you could <strong>redirect the users to the legit main web page</strong> of the victim, or redirect them to <em>/static/migration.html</em> for example, put some <strong>spinning wheel (</strong><a href="https://loading.io/"><strong>https://loading.io/</strong></a><strong>) for 5 seconds and then indicate that the process was successful</strong>.</p>
<h2 id="heading-27"></h2>
<p>Users &amp; Groups</p>
<ul>
<li><strong>Import the data</strong> (note that in order to use the template for the example you need the firstname, last name and email address of each user)</li>
</ul>
<p><img src="https://1517081779-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_2uGJGU7AVNRcqRvEi%2F-MP5FzPMR205bIINmIA6%2F-MP5GoIEExDGFlyi0JLa%2Fimage.png?alt=media&amp;token=ee626239-67e1-4ec7-9a62-5e6e221c64ee" alt=""></p>
<h2 id="heading-28"></h2>
<p>Campaign</p>
<p>Finally, create a campaign selecting a name, the email template, the landing page, the URL, the sending profile and the group. Note that the URL will be the link sent to the victims</p>
<p>Note that the <strong>Sending Profile allow to send a test email to see how will the final phishing email looks like</strong>:</p>
<p><img src="https://1517081779-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_2uGJGU7AVNRcqRvEi%2F-MP5FzPMR205bIINmIA6%2F-MP5ILcnSNFjmjQRdYOb%2Fimage.png?alt=media&amp;token=9c9abe1f-28dd-4b69-80ab-16b0097b5ed5" alt=""></p>
<p>I would recommend to <strong>send the test emails to 10min mails addresses</strong> in order to avoid getting blacklisted making tests.</p>
<p>Once everything is ready, just launch the campaign!</p>
<h2 id="heading-29"></h2>
<p>Website Cloning</p>
<p>If for any reason you want to clone the website check the following page:</p>
<h2 id="heading-30"></h2>
<p>Phishing2.0</p>
<p>The previous attack is pretty clever as you are faking a real website and gathering the information set by the user. Unfortunately, if the user didn&rsquo;t put the correct password or if the application you faked is configured with 2FA, <strong>this information won&rsquo;t allow you to impersonate the tricked user</strong>.</p>
<p>This is where tools like <a href="https://github.com/kgretzky/evilginx2"><strong>evilginx2</strong></a> or <a href="https://github.com/ustayready/CredSniper"><strong>CredSniper</strong></a> are useful. This tool will allow you to generate a MitM like attack. Basically, the attacks works in the following way:</p>
<ol>
<li>
<ol>
<li></li>
</ol>
</li>
</ol>
<pre><code>You **impersonate the login** form of the real webpage.
</code></pre>
<ol start="2">
<li>
<ol start="2">
<li></li>
</ol>
</li>
</ol>
<pre><code>The user **send** his **credentials** to your fake page and the tool send those to the real webpage, **checking if the credentials work**.
</code></pre>
<ol start="3">
<li>
<ol start="3">
<li></li>
</ol>
</li>
</ol>
<pre><code>If the account is configured with **2FA**, the MitM page will ask for it and once the **user introduces** it the tool will send it to the real web page.
</code></pre>
<ol start="4">
<li>
<ol start="4">
<li></li>
</ol>
</li>
</ol>
<pre><code>Once the user is authenticated you (as attacker) will have **captured the credentials, the 2FA, the cookie and any information** of every interaction your while the tool is performing a MitM.
</code></pre>
<h2 id="heading-31"></h2>
<p>Detecting the detection</p>
<p>Obviously one of the best ways to know if you have been busted is to <strong>search your domain inside blacklists</strong>. If it appears listed, somehow your domain was detected as suspicions. One easy way to check if you domain appears in any blacklist is to use <a href="https://malwareworld.com/">https://malwareworld.com/</a></p>
<p>However, there are other ways to know if the victim is <strong>actively looking for suspicions phishing activity in the wild</strong> as explained in:</p>
<p>You can <strong>buy a domain with a very similar name</strong> to the victims domain <strong>and/or generate a certificate</strong> for a <strong>subdomain</strong> of a domain controlled by you <strong>containing</strong> the <strong>keyword</strong> of the victim&rsquo;s domain. If the <strong>victim</strong> perform any kind of <strong>DNS or HTTP interaction</strong> with them, you will know that <strong>he is actively looking</strong> for suspicious domains and you will need to be very stealth.</p>
<h2 id="heading-32"></h2>
<p>Evaluate the phishing</p>
<p>Use <a href="https://github.com/Rices/Phishious"><strong>Phishious</strong></a> to evaluate if your email is going to end in the spam folder or if it&rsquo;s going to be blocked or successful.</p>
<h2 id="heading-33"></h2>
<p>References</p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/getting-start/" title="This is Great"> <i class="fa fa-chevron-left"></i><label>This is Great</label></a>
    <a class="nav nav-next" href="/getting-start/configuration/" title="Windows Keberos Attack" style="margin-right: 0px;"><label>Windows Keberos Attack</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    

    
    <div class="github-link">
      <a href="https://github.com/vjeantet/hugo-theme-docdock/edit/master/exampleSite/content/getting-start/installation.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script src="/js/clipboard.min.js"></script>
<script src="/js/featherlight.min.js"></script>

<script type="text/javascript" src="/js/lunr.min.js"></script>
<script type="text/javascript" src="/js/auto-complete.js"></script>
<script type="text/javascript" src="/js/search.js"></script>
<script src="/theme-flex/script.js"></script>




<script src="/js/scripts.min.js"></script>
    

    
    

    
  </body>
</html>